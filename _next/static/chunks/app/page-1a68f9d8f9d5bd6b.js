(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1931],{7792:function(e,a,t){Promise.resolve().then(t.bind(t,1969))},1969:function(e,a,t){"use strict";t.r(a);var i=t(7437),s=t(2265),l=t(8708),n=t(5606),r=t(9768),c=t(5319),m=t(5749),d=t(3508),o=t(5720),u=t(6648);t(7138),t(1656),t(594);class h extends s.Component{componentDidMount(){this.getData(),this.isAdmin()}isAdmin(){"duong171099"==localStorage.getItem("user")&&this.setState({flagAdmin:!0})}componentDidUpdate(e,a){this.state.flagAdmin||(localStorage.getItem("user"),window.location.href="/hsk")}render(){return this.state.flagAdmin?(0,i.jsx)(l.Z,{body:(0,i.jsxs)("div",{className:"container",children:[this.showBaidich(),this.state.loading?(0,i.jsx)(r.Z,{}):null]})}):(0,i.jsx)(r.Z,{})}constructor(e){var a;super(e),a=this,this.getData=async()=>{this.setState({loading:!0});let e=localStorage.getItem("user"),a=localStorage.getItem("name");var t=await JSON.parse(localStorage.getItem("allData"));t||await this.getAllData();let i=(t=await JSON.parse(localStorage.getItem("allData"))).find(e=>"dashboard"===e.key),s=t.find(e=>"account"===e.key);var l=Object.entries(i.value).map(e=>{let[a,t]=e;return{key:a,value:t}}),n=Object.entries(s.value).map(e=>{let[a,t]=e;return{key:a,value:t}});try{let t=await Promise.all(l.map(async a=>{let t=a.key,i=Object.entries(a.value).map(e=>{let[a,t]=e;return{key:a,value:t}}),s=await Promise.all(i.map(async a=>{let i="".concat(t,"&").concat(a.key);var s=a.value.comment?Object.entries(a.value.comment).map(e=>{let[a,t]=e;return{key:a,value:t}}):null,l=a.value.like?Object.entries(a.value.like).map(e=>{let[a,t]=e;return{key:a,value:t}}):null,r=a.value.tiengTrung?Object.entries(a.value.tiengTrung).map(e=>{let[a,t]=e;return{key:a,value:t}}):null,c=a.value.dichNghia?Object.entries(a.value.dichNghia).map(e=>{let[a,t]=e;return{key:a,value:t}}):null;let m=n.find(e=>e.key===t),[d,o,u,h,g,v,k,x,f,j,N,y,b,C,p]=await Promise.all([s,l,m.value.name,m.value.img,a.value.tieude,a.value.tieudeTiengTrung,a.value.author,a.value.imgAuthor,a.value.link,a.value.weblink,a.value.dateTime,a.value.id,a.value.baidich,r,c]),w=null,T=null,S=!1;return d&&(w=await Promise.all(d.map(async e=>{let a=d.find(a=>a.key===e.key),t=a.value.user,i=n.find(e=>e.key===t),[s,l,r,c]=await Promise.all([i.value.name,i.value.img,a.value.cmt,a.value.dateTime]);return{username:s,userImage:l,cmt:r,dateTime:c,id:e.key}}))),o&&(T=await Promise.all(o.map(async a=>{let t=o.find(e=>e.key===a.key);a.key===e&&(S=!0);let[i,s]=await Promise.all([t.value.name,t.value.image]);return{username:i,userImage:s}}))),{baivietKey:i,username:u,userImage:h,tieude:g,tieudeTiengTrung:v,author:k,imgAuthor:x,link:f,weblink:j,dateTime:N,comment:w,likes:T,id:y,baidich:b,isLiked:S,tiengTrungs:C,dichNghias:p}}));return{key:t,baivietDatas:s}})),i=[];t.forEach(e=>{i=i.concat(e.baivietDatas)}),i.sort((e,a)=>new Date(a.dateTime)-new Date(e.dateTime));let s={},r={},c={},m={},d={},o={},u={},h={},g={},v={},k={},x={},f={},j={},N={},y={};i.forEach(e=>{s[e.baivietKey]=e.weblink,r[e.baivietKey]=e.tieudeTiengTrung,c[e.baivietKey]=e.author,m[e.baivietKey]=e.link,d[e.baivietKey]=e.imgAuthor,o[e.baivietKey]=e.username,h[e.baivietKey]=e.tieude,u[e.baivietKey]=e.dateTime,g[e.baivietKey]=e.comment,v[e.baivietKey]=e.likes,k[e.baivietKey]=e.id,x[e.baivietKey]=e.userImage,f[e.baivietKey]=e.baidich,j[e.baivietKey]=e.isLiked,N[e.baivietKey]=e.tiengTrungs,y[e.baivietKey]=e.dichNghias}),this.setState({datas:i,myUser:e,MyUserName:a,baidichs:f,weblinks:s,tieudeTiengTrungs:r,authors:c,imgAuthors:d,links:m,usernames:o,userImages:x,tieudes:h,dateTimes:u,comments:g,likes:v,ids:k,isLikedMap:j,loading:!1,tiengTrungs:N,dichNghias:y})}catch(e){this.setState({error:e,loading:!1}),console.error("Error fetching data:",e)}},this.getAllData=async()=>{try{let e=(await (0,n.UD)("/users")).map(e=>{if("account"===e.key&&e.value){let a={};for(let t in e.value)if(e.value.hasOwnProperty(t)){let{username:i,password:s,...l}=e.value[t];a[t]=l}return{...e,value:a}}return e});await localStorage.setItem("allData",JSON.stringify(e))}catch(e){console.error("Error fetching data:",e)}},this.removeClick=async function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(await (0,n.Z6)(e),i){let i=e.split("/").pop();a.setState(e=>({comments:{...e.comments,[t]:e.comments[t].filter(e=>e.id!==i)}}))}else a.setState(e=>({datas:e.datas.filter(e=>e.baivietKey!==t),baidichs:a.filterOutKey(e.baidichs,t),weblinks:a.filterOutKey(e.weblinks,t),tieudeTiengTrungs:a.filterOutKey(e.tieudeTiengTrungs,t),authors:a.filterOutKey(e.authors,t),imgAuthors:a.filterOutKey(e.imgAuthors,t),links:a.filterOutKey(e.links,t),usernames:a.filterOutKey(e.usernames,t),userImages:a.filterOutKey(e.userImages,t),tieudes:a.filterOutKey(e.tieudes,t),dateTimes:a.filterOutKey(e.dateTimes,t),comments:a.filterOutKey(e.comments,t),likes:a.filterOutKey(e.likes,t),ids:a.filterOutKey(e.ids,t),tiengTrungs:a.filterOutKey(e.tiengTrungs,t),dichNghias:a.filterOutKey(e.dichNghias,t)}))},this.filterOutKey=(e,a)=>{let{[a]:t,...i}=e;return i},this.sendCmtHandle=async(e,a)=>{let t=this.state.commentTexts[a],i=localStorage.getItem("user"),s=localStorage.getItem("name"),l=localStorage.getItem("userImage");if(i){let r="".concat(e,"/comment"),c=await (0,n.UD)(r),m=new Date().toISOString(),o=null;o=c?c.length+1:1;let u="".concat(o,"-").concat((0,d.o0)(m));await (0,n.Pf)("".concat(r,"/").concat(u,"/user"),i),await (0,n.Pf)("".concat(r,"/").concat(u,"/cmt"),t),await (0,n.Pf)("".concat(r,"/").concat(u,"/dateTime"),m);let h={username:s,userImage:l,cmt:t,dateTime:m,id:u};this.setState(e=>({comments:{...e.comments,[a]:[...e.comments[a]||[],h]},commentTexts:{...e.commentTexts,[a]:""}}))}},this.likeClick=async(e,a,t)=>{let i=localStorage.getItem("user"),s=localStorage.getItem("name"),l=localStorage.getItem("userImage");if(i){let r="".concat(e,"/like");if(t)await (0,n.Z6)("".concat(r,"/").concat(i)),this.setState(e=>({likes:{...e.likes,[a]:e.likes[a].filter(e=>e.username!==s)},isLikedMap:{...e.isLikedMap,[a]:!1}}));else{await (0,n.Pf)("".concat(r,"/").concat(i,"/name"),s),await (0,n.Pf)("".concat(r,"/").concat(i,"/image"),l);let e={username:s,userImage:l};this.setState(t=>({likes:{...t.likes,[a]:[...t.likes[a]||[],e]},isLikedMap:{...t.isLikedMap,[a]:!0}}))}}},this.handleCommentChange=(e,a)=>{this.setState(t=>({commentTexts:{...t.commentTexts,[e]:a.target.value}}))},this.showBaidich=()=>{let{datas:e,baidichs:a,userImages:t,usernames:s,commentTexts:l,likes:n,dateTimes:r,comments:m,tieudes:d,tieudeTiengTrungs:u,ids:h,isLikedMap:g,tiengTrungs:v,dichNghias:k}=this.state;return e&&e.length>0?e.map((e,x)=>{let f=e.baivietKey,j=f.split("&")[0],N="/users/dashboard/".concat(j,"/").concat(f.split("&")[1]);return(0,i.jsx)(c.Z,{username:s[f]||null,dateTime:r[f]||null,imgUser:t[f]||null,comment:m[f]?this.showComment(N,m[f],f):null,likes:n[f]?(0,i.jsx)(o.Z,{likes:n[f]}):null,tieudeTiengTrung:u[f]||null,link:f?"/dashboard/".concat(j,"/").concat(f.split("&")[1]):null,title:d[f]||null,baidich:a[f]||null,img:h[f]?"https://img.youtube.com/vi/".concat(h[f],"/sddefault.jpg"):null,removeClick:()=>this.removeClick(N,f,!1),sendCmtHandle:()=>this.sendCmtHandle(N,f),commentText:l[f]||"",onChangeHandle:e=>this.handleCommentChange(f,e),likeClick:()=>this.likeClick(N,f,g[f]),isLiked:g[f],tiengTrungs:v[f]||null,dichNghias:k[f]||null,userKey:j||null},x)}):null},this.showComment=(e,a,t)=>(0,i.jsx)("div",{children:a&&a.map((a,s)=>(0,i.jsx)(g,{imgUser:a.userImage,username:a.username,cmt:a.cmt,dateTime:a.dateTime,removeClick:()=>this.removeClick("".concat(e,"/comment/").concat(a.id),t,!0)},s))}),this.state={datas:null,usernames:null,dateTimes:null,tieudes:null,links:null,likes:null,comments:null,weblinks:null,tieudeTiengTrungs:null,authors:null,imgAuthors:null,baidichs:null,error:null,nav:!1,loading:!1,commentTexts:{},isLikedMap:{},flagLogin:!1,flagAdmin:!1}}}function g(e){return(0,i.jsxs)("div",{className:"itemCard-UserName",children:[(0,i.jsxs)("div",{className:"itemCard-UserName-2",children:[(0,i.jsx)(u.default,{src:e.imgUser?e.imgUser:m.Z,alt:"img",width:500,height:500}),(0,i.jsxs)("div",{className:"itemCard-UserName-container ",children:[(0,i.jsxs)("div",{className:"itemCard-UserName-container-1",children:[(0,i.jsx)("h6",{className:"username-card1",children:e.username}),(0,i.jsx)("p",{children:e.cmt})]}),(0,i.jsx)("span",{className:"Time",style:{margin:"0"},children:(0,d.o0)(e.dateTime)})]})]}),localStorage.getItem("name")==e.username?(0,i.jsx)("div",{className:"itemCard-UserName-1",children:(0,i.jsx)("button",{className:"btn btn-options",onClick:e.removeClick,style:{padding:"0",margin:"0"},children:(0,i.jsx)("i",{className:"fa-solid fa-trash"})})}):null]})}a.default=h},5319:function(e,a,t){"use strict";var i=t(7437),s=t(2265),l=t(9782),n=t(1213),r=t(7138),c=t(5749),m=t(6648);let d=s.memo(e=>{let[a,t]=(0,s.useState)(!1),[d,o]=(0,s.useState)(!1),u=(e,t)=>!a&&e&&e.length>t?(0,i.jsxs)(i.Fragment,{children:[e.substring(0,t),"...",(0,i.jsx)("span",{className:"see-more",onClick:()=>h(),style:{cursor:"pointer",color:"blue"},children:"xem th\xeam"})]}):e,h=()=>{t(!a)},[g,v]=(0,s.useState)(!1),[k,x]=(0,s.useState)(""),f=a=>{e.onChangeHandle&&e.onChangeHandle(a)};return(0,i.jsxs)("div",{className:"itemCard-container-dashboard",onClick:e.cardClick,onMouseEnter:e.cardClick,children:[(0,i.jsxs)("div",{className:"itemCard-UserName",children:[(0,i.jsxs)("div",{className:"itemCard-UserName-1",children:[(0,i.jsx)(r.default,{href:"/".concat(e.userKey),children:(0,i.jsx)(m.default,{src:e.imgUser?e.imgUser:c.Z,alt:"img",width:50,height:50})}),(0,i.jsxs)("div",{className:"itemCard-UserName-container cambria",children:[(0,i.jsx)("h4",{className:"username-card",children:e.username}),(0,i.jsx)("p",{style:{margin:"0"},children:(e=>{if(!e)return"";try{let a=new Date(e);return(0,l.WU)(a,"h:mm a, dd 'Th\xe1ng' MM, yyyy",{locale:n.vi})}catch(a){return console.error("Invalid date format:",e),e}})(e.dateTime)})]})]}),(()=>{let a=localStorage.getItem("name");return e.username==a?(0,i.jsx)("div",{className:"itemCard-UserName-1",children:(0,i.jsx)("button",{className:"btn btn-options",onClick:e.removeClick,style:{padding:"0",margin:"0"},children:(0,i.jsx)("i",{className:"fa-solid fa-trash"})})}):null})()]}),(()=>{if(e.tiengTrungs){let a=Object.values(e.tiengTrungs);return a.length>0?(0,i.jsxs)("div",{className:"itemCard-baiDich",onDoubleClick:()=>o(!d),children:[a.slice(0,d?a.length:3).map((a,t)=>(0,i.jsxs)("div",{className:"textDashboard_container",children:[(0,i.jsx)("pre",{className:"tiengTrung_Dashboard simsun",children:a.value}),(0,i.jsx)("pre",{className:"dichNghia_Dashboard cambria",children:e.dichNghias[t]?e.dichNghias[t].value:null})]},t)),!d&&a.length>3&&(0,i.jsx)("span",{className:"see-more",onClick:()=>o(!0),style:{cursor:"pointer",color:"blue"},children:"...xem th\xeam"})]}):null}if(e.baidich)return(0,i.jsx)("div",{className:"itemCard-baiDich",children:e.img?(0,i.jsx)("pre",{onDoubleClick:()=>h(),children:u(e.baidich,300)}):(0,i.jsx)("pre",{children:e.baidich})})})(),e.img&&(0,i.jsx)(r.default,{href:e.link,passHref:!0,legacyBehavior:!0,children:(0,i.jsx)("a",{className:"itemCard-title-dashboard",onClick:e.cardClick,children:(0,i.jsx)(m.default,{src:e.img,alt:"null",width:500,height:500})})}),(0,i.jsxs)("div",{className:"itemCard-content",children:[e.img&&(0,i.jsx)("h3",{className:"itemCard-content-title cambria",children:e.title}),e.img&&(0,i.jsx)("div",{className:"itemCard-content-description simsun",children:(0,i.jsx)("span",{children:e.tieudeTiengTrung})}),(0,i.jsxs)("div",{className:"ItemCard-dashboard-footer",children:[(0,i.jsxs)("div",{className:"ItemCard-interact",children:[(0,i.jsxs)("div",{className:"ItemCard-interact-likeview",children:[(0,i.jsx)("div",{className:"liked-view",children:(0,i.jsx)("i",{className:"fa-solid fa-thumbs-up"})}),(0,i.jsx)("span",{className:"ItemCard-interact-liked",children:(0,i.jsx)("div",{children:e.likes})})]}),(0,i.jsx)("hr",{}),localStorage.getItem("name")?(0,i.jsxs)("div",{className:"row ItemCard-interact-container",children:[(0,i.jsx)("div",{className:"col-6",onClick:()=>{v(!g),e.likeClick()},children:(0,i.jsx)("div",{className:"ItemCard-interact-item",children:(0,i.jsxs)("div",{className:"ItemCard-interact-item-flex ".concat(e.isLiked?"liked":""),children:[(0,i.jsx)("i",{className:"fa-regular fa-thumbs-up ".concat(e.isLiked?"liked-icon":"")}),(0,i.jsx)("span",{children:"Th\xedch"})]})})}),(0,i.jsx)("div",{className:"col-6",onClick:e.cmtClick,children:(0,i.jsx)("div",{className:"ItemCard-interact-item",children:(0,i.jsxs)("div",{className:"ItemCard-interact-item-flex",children:[(0,i.jsx)("i",{className:"fa-regular fa-comment"}),(0,i.jsx)("span",{children:"B\xecnh luận"})]})})})]}):null,(0,i.jsx)("hr",{})]}),(0,i.jsx)("div",{className:"itemCard-comment",children:(0,i.jsxs)("div",{className:"itemCard-comment-container",children:[(0,i.jsx)("div",{className:"itemCard-comment-viewer",children:e.comment}),(()=>{let a=localStorage.getItem("name"),t=localStorage.getItem("user"),s=JSON.parse(localStorage.getItem("allData")).find(e=>"account"===e.key).value[t];var l=c.Z;return(s&&s.img&&(l=s.img),a)?(0,i.jsxs)("div",{className:"itemCard-comment-write",children:[(0,i.jsx)("div",{className:"itemCard-user-image",children:(0,i.jsx)(m.default,{src:l,alt:"img",width:500,height:500})}),(0,i.jsxs)("div",{className:"comment-input-container",children:[(0,i.jsx)("textarea",{className:"form-control comment-input",name:e.name,"aria-describedby":"helpId",placeholder:"B\xecnh luận với vai tr\xf2 "+a,onChange:f,value:e.commentText}),(0,i.jsx)("div",{className:"itemCard-comment-send  ".concat(e.commentText?"active1":"no-item"),onClick:e.sendCmtHandle,children:(0,i.jsx)("i",{className:"fa-solid fa-paper-plane"})})]})]}):null})()]})})]})]})]})});d.displayName="ItemCardDashboard",a.Z=d},5720:function(e,a,t){"use strict";var i=t(7437),s=t(2265);a.Z=e=>{let{likes:a}=e,[t,l]=(0,s.useState)(!1),[n,r]=(0,s.useState)(!1);(0,s.useEffect)(()=>{m()});let c=localStorage.getItem("name"),m=()=>{a&&a.map(e=>{e.username===c&&r(!0)})};return(0,i.jsxs)("div",{className:"likeView-controller",children:[(0,i.jsx)("div",{className:"likeView-header",onClick:()=>{l(!t)},children:a[0]?(n?"Bạn":a[0].username)+(a[1]?" v\xe0 "+(a.length-1)+" người kh\xe1c":""):null}),(0,i.jsx)("div",{className:t?"likeView-detailes":"hidden",children:a&&a.map((e,a)=>(0,i.jsx)("div",{className:"liked-user",children:(0,i.jsx)("span",{children:e.username})},a))})]})}},1656:function(){},594:function(){}},function(e){e.O(0,[734,6610,4358,7481,9208,9461,5973,7143,8472,609,6901,7468,2971,7023,1744],function(){return e(e.s=7792)}),_N_E=e.O()}]);