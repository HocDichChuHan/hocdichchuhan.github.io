(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[157],{9693:function(e,a,t){Promise.resolve().then(t.bind(t,4456))},4456:function(e,a,t){"use strict";t.d(a,{default:function(){return g}});var i=t(7437),l=t(2265),n=t(8708),s=t(5606);t(9768);var r=t(5319),c=t(5749),m=t(3508),u=t(5720),o=t(6648),d=t(7138);function g(e){let{user:a}=e;var t=this;let[g,v]=(0,l.useState)({datas:null,usernames:null,dateTimes:null,tieudes:null,links:null,likes:null,comments:null,weblinks:null,tieudeTiengTrungs:null,authors:null,imgAuthors:null,baidichs:null,error:null,nav:!1,loading:!1,commentTexts:{},isLikedMap:{},flagLogin:!1,flagAdmin:!1,userData:null}),[k,f]=(0,l.useState)(!0);(0,l.useEffect)(()=>{b()},[]);let b=async()=>{let e=localStorage.getItem("user"),t=localStorage.getItem("name"),i=JSON.parse(localStorage.getItem("allData"));if(!i)return;let l=i.find(e=>"dashboard"===e.key),n=i.find(e=>"account"===e.key),s=n.value[a];var r=Object.entries(l.value).map(e=>{let[a,t]=e;return{key:a,value:t}}),c=Object.entries(n.value).map(e=>{let[a,t]=e;return{key:a,value:t}});try{let a=await Promise.all(r.map(async a=>{let t=a.key,i=Object.entries(a.value).map(e=>{let[a,t]=e;return{key:a,value:t}}),l=await Promise.all(i.map(async a=>{let i="".concat(t,"&").concat(a.key);var l=a.value.comment?Object.entries(a.value.comment).map(e=>{let[a,t]=e;return{key:a,value:t}}):null,n=a.value.like?Object.entries(a.value.like).map(e=>{let[a,t]=e;return{key:a,value:t}}):null,s=a.value.tiengTrung?Object.entries(a.value.tiengTrung).map(e=>{let[a,t]=e;return{key:a,value:t}}):null,r=a.value.dichNghia?Object.entries(a.value.dichNghia).map(e=>{let[a,t]=e;return{key:a,value:t}}):null;let m=c.find(e=>e.key===t),[u,o,d,g,h,v,k,f,b,y,p,x,T,j,N]=await Promise.all([l,n,m.value.name,m.value.img,a.value.tieude,a.value.tieudeTiengTrung,a.value.author,a.value.imgAuthor,a.value.link,a.value.weblink,a.value.dateTime,a.value.id,a.value.baidich,s,r]),w=null,I=null,K=!1;return u&&(w=await Promise.all(u.map(async e=>{let a=u.find(a=>a.key===e.key),t=a.value.user,i=c.find(e=>e.key===t),[l,n,s,r]=await Promise.all([i.value.name,i.value.img,a.value.cmt,a.value.dateTime]);return{username:l,userImage:n,cmt:s,dateTime:r,id:e.key}}))),o&&(I=await Promise.all(o.map(async a=>{let t=o.find(e=>e.key===a.key);a.key===e&&(K=!0);let[i,l]=await Promise.all([t.value.name,t.value.image]);return{username:i,userImage:l}}))),{baivietKey:i,username:d,userImage:g,tieude:h,tieudeTiengTrung:v,author:k,imgAuthor:f,link:b,weblink:y,dateTime:p,comment:w,likes:I,id:x,baidich:T,isLiked:K,tiengTrungs:j,dichNghias:N}}));return{key:t,baivietDatas:l}})),i=[];a.forEach(e=>{i=i.concat(e.baivietDatas)}),i.sort((e,a)=>new Date(a.dateTime)-new Date(e.dateTime));let l={},n={},m={},u={},o={},d={},g={},h={},k={},f={},b={},y={},p={},x={},T={},j={};i.forEach(e=>{l[e.baivietKey]=e.weblink,n[e.baivietKey]=e.tieudeTiengTrung,m[e.baivietKey]=e.author,u[e.baivietKey]=e.link,o[e.baivietKey]=e.imgAuthor,d[e.baivietKey]=e.username,h[e.baivietKey]=e.tieude,g[e.baivietKey]=e.dateTime,k[e.baivietKey]=e.comment,f[e.baivietKey]=e.likes,b[e.baivietKey]=e.id,y[e.baivietKey]=e.userImage,p[e.baivietKey]=e.baidich,x[e.baivietKey]=e.isLiked,T[e.baivietKey]=e.tiengTrungs,j[e.baivietKey]=e.dichNghias});let N=i;v(a=>({...a,datas:N,myUser:e,MyUserName:t,baidichs:p,weblinks:l,tieudeTiengTrungs:n,authors:m,imgAuthors:o,links:u,usernames:d,userImages:y,tieudes:h,dateTimes:g,comments:k,likes:f,ids:b,isLikedMap:x,loading:!1,tiengTrungs:T,dichNghias:j,userData:s}))}catch(e){v({error:e,loading:!1}),console.error("Error fetching data:",e)}},y=async function(e,a){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(await (0,s.Z6)(e),i){let i=e.split("/").pop();t.setState(e=>({comments:{...e.comments,[a]:e.comments[a].filter(e=>e.id!==i)}}))}else v(e=>({datas:e.datas.filter(e=>e.baivietKey!==a),baidichs:p(e.baidichs,a),weblinks:p(e.weblinks,a),tieudeTiengTrungs:p(e.tieudeTiengTrungs,a),authors:p(e.authors,a),imgAuthors:p(e.imgAuthors,a),links:p(e.links,a),usernames:p(e.usernames,a),userImages:p(e.userImages,a),tieudes:p(e.tieudes,a),dateTimes:p(e.dateTimes,a),comments:p(e.comments,a),likes:p(e.likes,a),ids:p(e.ids,a),tiengTrungs:p(e.tiengTrungs,a),dichNghias:p(e.dichNghias,a)}))},p=(e,a)=>{let{[a]:t,...i}=e;return i},x=async(e,a)=>{let t=this.state.commentTexts[a],i=localStorage.getItem("user"),l=localStorage.getItem("name"),n=localStorage.getItem("userImage");if(i){let r="".concat(e,"/comment"),c=await (0,s.UD)(r),u=new Date().toISOString(),o=null;o=c?c.length+1:1;let d="".concat(o,"-").concat((0,m.o)(u));await (0,s.Pf)("".concat(r,"/").concat(d,"/user"),i),await (0,s.Pf)("".concat(r,"/").concat(d,"/cmt"),t),await (0,s.Pf)("".concat(r,"/").concat(d,"/dateTime"),u);let g={username:l,userImage:n,cmt:t,dateTime:u,id:d};v(e=>({comments:{...e.comments,[a]:[...e.comments[a]||[],g]},commentTexts:{...e.commentTexts,[a]:""}}))}},T=async(e,a,t)=>{let i=localStorage.getItem("user"),l=localStorage.getItem("name"),n=localStorage.getItem("userImage");if(i){let r="".concat(e,"/like");if(t)await (0,s.Z6)("".concat(r,"/").concat(i)),v(e=>({likes:{...e.likes,[a]:e.likes[a].filter(e=>e.username!==l)},isLikedMap:{...e.isLikedMap,[a]:!1}}));else{await (0,s.Pf)("".concat(r,"/").concat(i,"/name"),l),await (0,s.Pf)("".concat(r,"/").concat(i,"/image"),n);let e={username:l,userImage:n};v(t=>({likes:{...t.likes,[a]:[...t.likes[a]||[],e]},isLikedMap:{...t.isLikedMap,[a]:!0}}))}}},j=(e,a)=>{v(t=>({commentTexts:{...t.commentTexts,[e]:a.target.value}}))},N=(e,a,t)=>(0,i.jsx)("div",{children:a&&a.map((a,l)=>(0,i.jsx)(h,{imgUser:a.userImage,username:a.username,cmt:a.cmt,dateTime:a.dateTime,removeClick:()=>y("".concat(e,"/comment/").concat(a.id),t,!0)},l))});return(0,i.jsx)(n.Z,{body:(0,i.jsxs)("div",{className:"container",children:[(()=>{let{userData:e}=g;if(!e)return;let a=e.img?e.img:c.Z;return(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"userDataContainer",children:[(0,i.jsx)("div",{className:"userDataImage",children:(0,i.jsx)(d.default,{href:"",passHref:!0,legacyBehavior:!0,children:(0,i.jsx)(o.default,{src:a,alt:"null",width:300,height:300})})}),(0,i.jsxs)("div",{className:"userDataInfo",children:[(0,i.jsx)("h3",{children:e.name}),(0,i.jsx)("br",{}),(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,i.jsx)("i",{className:"nav-icon fa-solid fa-user-pen"}),(0,i.jsx)(d.default,{href:"",passHref:!0,legacyBehavior:!0,children:"Chỉnh sửa trang c\xe1 nh\xe2n"})]})]})]}),(0,i.jsx)("hr",{})]})})(),(()=>{let{datas:e,baidichs:t,userImages:l,usernames:n,commentTexts:s,likes:c,dateTimes:m,comments:o,tieudes:d,tieudeTiengTrungs:h,ids:v,isLikedMap:k,tiengTrungs:f,dichNghias:b}=g;var p=!1;return e&&e.length>0?(e.map((e,t)=>{e.baivietKey.split("&")[0]==a&&(p=!0)}),p)?e.map((e,g)=>{let p=e.baivietKey,w=p.split("&")[0];if(w!=a)return null;let I="/users/dashboard/".concat(w,"/").concat(p.split("&")[1]);return(0,i.jsx)(r.Z,{username:n[p]||null,dateTime:m[p]||null,imgUser:l[p]||null,comment:o[p]?N(I,o[p],p):null,likes:c[p]?(0,i.jsx)(u.Z,{likes:c[p]}):null,tieudeTiengTrung:h[p]||null,link:p?"/dashboard/".concat(w,"/").concat(p.split("&")[1]):null,title:d[p]||null,baidich:t[p]||null,img:v[p]?"https://img.youtube.com/vi/".concat(v[p],"/sddefault.jpg"):null,removeClick:()=>y(I,p,!1),sendCmtHandle:()=>x(I,p),commentText:s[p]||"",onChangeHandle:e=>j(p,e),likeClick:()=>T(I,p,k[p]),isLiked:k[p],tiengTrungs:f[p]||null,dichNghias:b[p]||null},g)}):(0,i.jsx)("div",{children:(0,i.jsx)("h2",{children:"Bạn chưa c\xf3 b\xe0i đăng n\xe0o"})}):null})()]})})}function h(e){return(0,i.jsxs)("div",{className:"itemCard-UserName",children:[(0,i.jsxs)("div",{className:"itemCard-UserName-2",children:[(0,i.jsx)(o.default,{src:e.imgUser?e.imgUser:c.Z,alt:"img",width:500,height:500}),(0,i.jsxs)("div",{className:"itemCard-UserName-container ",children:[(0,i.jsxs)("div",{className:"itemCard-UserName-container-1",children:[(0,i.jsx)("h6",{className:"username-card1",children:e.username}),(0,i.jsx)("p",{children:e.cmt})]}),(0,i.jsx)("span",{className:"Time",style:{margin:"0"},children:(0,m.o)(e.dateTime)})]})]}),localStorage.getItem("name")==e.username?(0,i.jsx)("div",{className:"itemCard-UserName-1",children:(0,i.jsx)("button",{className:"btn btn-options",onClick:e.removeClick,style:{padding:"0",margin:"0"},children:(0,i.jsx)("i",{className:"fa-solid fa-trash"})})}):null]})}}},function(e){e.O(0,[481,461,630,648,609,708,669,971,23,560],function(){return e(e.s=9693)}),_N_E=e.O()}]);