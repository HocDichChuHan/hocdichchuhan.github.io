(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1157],{89693:function(e,a,i){Promise.resolve().then(i.bind(i,14456))},14456:function(e,a,i){"use strict";i.d(a,{default:function(){return x}});var t=i(57437),s=i(2265),l=i(66802),n=i(65606);i(19768);var r=i(25319),c=i(45749),m=i(23508),d=i(45720),o=i(66648),u=i(87138),h=i(12808),g=i(64379),v=i.n(g);function x(e){let{user:a}=e;var i=this;let[g,x]=(0,s.useState)({datas:null,usernames:null,dateTimes:null,tieudes:null,links:null,likes:null,comments:null,weblinks:null,tieudeTiengTrungs:null,authors:null,imgAuthors:null,baidichs:null,error:null,nav:!1,loading:!1,commentTexts:{},isLikedMap:{},flagLogin:!1,flagAdmin:!1,userData:{name:"",img:"",email:""},flagUpdate:!1,myUser:null}),[f,N]=(0,s.useState)(!0);(0,s.useEffect)(()=>{k()},[]);let k=async()=>{let e=localStorage.getItem("user"),i=localStorage.getItem("name"),t=JSON.parse(localStorage.getItem("allData"));if(!t)return;let s=t.find(e=>"dashboard"===e.key),l=t.find(e=>"account"===e.key),n=l.value[a];var r=Object.entries(s.value).map(e=>{let[a,i]=e;return{key:a,value:i}}),c=Object.entries(l.value).map(e=>{let[a,i]=e;return{key:a,value:i}});try{let a=await Promise.all(r.map(async a=>{let i=a.key,t=Object.entries(a.value).map(e=>{let[a,i]=e;return{key:a,value:i}}),s=await Promise.all(t.map(async a=>{let t="".concat(i,"&").concat(a.key);var s=a.value.comment?Object.entries(a.value.comment).map(e=>{let[a,i]=e;return{key:a,value:i}}):null,l=a.value.like?Object.entries(a.value.like).map(e=>{let[a,i]=e;return{key:a,value:i}}):null,n=a.value.tiengTrung?Object.entries(a.value.tiengTrung).map(e=>{let[a,i]=e;return{key:a,value:i}}):null,r=a.value.dichNghia?Object.entries(a.value.dichNghia).map(e=>{let[a,i]=e;return{key:a,value:i}}):null;let m=c.find(e=>e.key===i),[d,o,u,h,g,v,x,j,f,N,k,p,b,C,y]=await Promise.all([s,l,m.value.name,m.value.img,a.value.tieude,a.value.tieudeTiengTrung,a.value.author,a.value.imgAuthor,a.value.link,a.value.weblink,a.value.dateTime,a.value.id,a.value.baidich,n,r]),T=null,w=null,I=!1;return d&&(T=await Promise.all(d.map(async e=>{let a=d.find(a=>a.key===e.key),i=a.value.user,t=c.find(e=>e.key===i),[s,l,n,r]=await Promise.all([t.value.name,t.value.img,a.value.cmt,a.value.dateTime]);return{username:s,userImage:l,cmt:n,dateTime:r,id:e.key}}))),o&&(w=await Promise.all(o.map(async a=>{let i=o.find(e=>e.key===a.key);a.key===e&&(I=!0);let[t,s]=await Promise.all([i.value.name,i.value.image]);return{username:t,userImage:s}}))),{baivietKey:t,username:u,userImage:h,tieude:g,tieudeTiengTrung:v,author:x,imgAuthor:j,link:f,weblink:N,dateTime:k,comment:T,likes:w,id:p,baidich:b,isLiked:I,tiengTrungs:C,dichNghias:y}}));return{key:i,baivietDatas:s}})),t=[];a.forEach(e=>{t=t.concat(e.baivietDatas)}),t.sort((e,a)=>new Date(a.dateTime)-new Date(e.dateTime));let s={},l={},m={},d={},o={},u={},h={},g={},v={},j={},f={},N={},k={},p={},b={},C={};t.forEach(e=>{s[e.baivietKey]=e.weblink,l[e.baivietKey]=e.tieudeTiengTrung,m[e.baivietKey]=e.author,d[e.baivietKey]=e.link,o[e.baivietKey]=e.imgAuthor,u[e.baivietKey]=e.username,g[e.baivietKey]=e.tieude,h[e.baivietKey]=e.dateTime,v[e.baivietKey]=e.comment,j[e.baivietKey]=e.likes,f[e.baivietKey]=e.id,N[e.baivietKey]=e.userImage,k[e.baivietKey]=e.baidich,p[e.baivietKey]=e.isLiked,b[e.baivietKey]=e.tiengTrungs,C[e.baivietKey]=e.dichNghias});let y=t;x(a=>({...a,datas:y,myUser:e,MyUserName:i,baidichs:k,weblinks:s,tieudeTiengTrungs:l,authors:m,imgAuthors:o,links:d,usernames:u,userImages:N,tieudes:g,dateTimes:h,comments:v,likes:j,ids:f,isLikedMap:p,loading:!1,tiengTrungs:b,dichNghias:C,userData:n,myUser:e}))}catch(e){x({error:e,loading:!1}),console.error("Error fetching data:",e)}},p=async()=>{let e=localStorage.getItem("user"),{userData:a}=g;console.log(a.name);try{await (0,n.Pf)("/users/account/".concat(e,"/name"),a.name),await (0,n.Pf)("/users/account/".concat(e,"/img"),a.img),await v().fire({position:"center",icon:"success",title:"Cập nhật th\xe0nh c\xf4ng",showConfirmButton:!1,timer:1500}),S()}catch(e){console.error("Lỗi tạo b\xe0i mới:",e),v().fire("Lỗi tạo b\xe0i mới: "+e.message,"","info")}},b=async function(e,a){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(await (0,n.Z6)(e),t){let t=e.split("/").pop();i.setState(e=>({comments:{...e.comments,[a]:e.comments[a].filter(e=>e.id!==t)}}))}else x(e=>({datas:e.datas.filter(e=>e.baivietKey!==a),baidichs:C(e.baidichs,a),weblinks:C(e.weblinks,a),tieudeTiengTrungs:C(e.tieudeTiengTrungs,a),authors:C(e.authors,a),imgAuthors:C(e.imgAuthors,a),links:C(e.links,a),usernames:C(e.usernames,a),userImages:C(e.userImages,a),tieudes:C(e.tieudes,a),dateTimes:C(e.dateTimes,a),comments:C(e.comments,a),likes:C(e.likes,a),ids:C(e.ids,a),tiengTrungs:C(e.tiengTrungs,a),dichNghias:C(e.dichNghias,a)}))},C=(e,a)=>{let{[a]:i,...t}=e;return t},y=async(e,a)=>{let i=this.state.commentTexts[a],t=localStorage.getItem("user"),s=localStorage.getItem("name"),l=localStorage.getItem("userImage");if(t){let r="".concat(e,"/comment"),c=await (0,n.UD)(r),d=new Date().toISOString(),o=null;o=c?c.length+1:1;let u="".concat(o,"-").concat((0,m.o0)(d));await (0,n.Pf)("".concat(r,"/").concat(u,"/user"),t),await (0,n.Pf)("".concat(r,"/").concat(u,"/cmt"),i),await (0,n.Pf)("".concat(r,"/").concat(u,"/dateTime"),d);let h={username:s,userImage:l,cmt:i,dateTime:d,id:u};x(e=>({comments:{...e.comments,[a]:[...e.comments[a]||[],h]},commentTexts:{...e.commentTexts,[a]:""}}))}},T=async(e,a,i)=>{let t=localStorage.getItem("user"),s=localStorage.getItem("name"),l=localStorage.getItem("userImage");if(t){let r="".concat(e,"/like");if(i)await (0,n.Z6)("".concat(r,"/").concat(t)),x(e=>({likes:{...e.likes,[a]:e.likes[a].filter(e=>e.username!==s)},isLikedMap:{...e.isLikedMap,[a]:!1}}));else{await (0,n.Pf)("".concat(r,"/").concat(t,"/name"),s),await (0,n.Pf)("".concat(r,"/").concat(t,"/image"),l);let e={username:s,userImage:l};x(i=>({likes:{...i.likes,[a]:[...i.likes[a]||[],e]},isLikedMap:{...i.isLikedMap,[a]:!0}}))}}},w=(e,a)=>{x(i=>({commentTexts:{...i.commentTexts,[e]:a.target.value}}))},I=(e,a,i)=>(0,t.jsx)("div",{children:a&&a.map((a,s)=>(0,t.jsx)(j,{imgUser:a.userImage,username:a.username,cmt:a.cmt,dateTime:a.dateTime,removeClick:()=>b("".concat(e,"/comment/").concat(a.id),i,!0)},s))}),S=()=>{x(e=>({...e,flagUpdate:!e.flagUpdate}))},D=e=>{let{name:a,value:i}=e.target;x(e=>({...e,userData:{...e.userData,[a]:i}}))};return(0,t.jsx)(l.Z,{body:(0,t.jsxs)("div",{className:"container",children:[(()=>{let{userData:e,flagUpdate:i,myUser:s}=g;if(!e)return;let l=e.img?e.img:c.Z;return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"userDataContainer",children:[(0,t.jsx)("div",{className:"userDataImage",children:(0,t.jsx)(u.default,{href:"",passHref:!0,legacyBehavior:!0,children:(0,t.jsx)(o.default,{src:l,alt:"null",width:300,height:300})})}),!i&&(0,t.jsxs)("div",{className:"userDataInfo",children:[(0,t.jsx)("h3",{children:e.name}),(0,t.jsx)("br",{}),s==a&&(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,t.jsx)("i",{className:"nav-icon fa-solid fa-user-pen"}),(0,t.jsx)("div",{className:"update-personal",onClick:()=>S(),children:"Chỉnh sửa th\xf4ng tin c\xe1 nh\xe2n"})]})]}),i&&(0,t.jsxs)("div",{className:"userDataInfo",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("h5",{children:"T\xean của bạn"}),(0,t.jsx)("input",{type:"text",className:"form-control",name:"name",placeholder:"Nhập t\xean của bạn",value:e.name,onChange:D})]}),(0,t.jsx)("br",{}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("h5",{children:"Đường dẫn ảnh đại diện của bạn"}),(0,t.jsx)("input",{type:"text",className:"form-control",name:"img",id:"","aria-describedby":"helpId",placeholder:"Nhập đường dẫn ảnh đại diện của bạn",value:e.img,onChange:D})]}),(0,t.jsx)("br",{}),(0,t.jsx)(h.Z,{variant:"info",onClick:()=>p(),children:"Cập nhật"}),(0,t.jsx)(h.Z,{variant:"danger",children:"Hủy"})]}),(0,t.jsx)("br",{})]})]}),(0,t.jsx)("hr",{})]})})(),(()=>{let{datas:e,baidichs:i,userImages:s,usernames:l,commentTexts:n,likes:c,dateTimes:m,comments:o,tieudes:u,tieudeTiengTrungs:h,ids:v,isLikedMap:x,tiengTrungs:j,dichNghias:f}=g;var N=!1;return e&&e.length>0?(e.map((e,i)=>{e.baivietKey.split("&")[0]==a&&(N=!0)}),N)?e.map((e,g)=>{let N=e.baivietKey,k=N.split("&")[0];if(k!=a)return null;let p="/users/dashboard/".concat(k,"/").concat(N.split("&")[1]);return(0,t.jsx)(r.Z,{username:l[N]||null,dateTime:m[N]||null,imgUser:s[N]||null,comment:o[N]?I(p,o[N],N):null,likes:c[N]?(0,t.jsx)(d.Z,{likes:c[N]}):null,tieudeTiengTrung:h[N]||null,link:N?"/dashboard/".concat(k,"/").concat(N.split("&")[1]):null,title:u[N]||null,baidich:i[N]||null,img:v[N]?"https://img.youtube.com/vi/".concat(v[N],"/sddefault.jpg"):null,removeClick:()=>b(p,N,!1),sendCmtHandle:()=>y(p,N),commentText:n[N]||"",onChangeHandle:e=>w(N,e),likeClick:()=>T(p,N,x[N]),isLiked:x[N],tiengTrungs:j[N]||null,dichNghias:f[N]||null},g)}):(0,t.jsx)("div",{children:(0,t.jsx)("h2",{children:"Bạn chưa c\xf3 b\xe0i đăng n\xe0o"})}):null})()]})})}function j(e){return(0,t.jsxs)("div",{className:"itemCard-UserName",children:[(0,t.jsxs)("div",{className:"itemCard-UserName-2",children:[(0,t.jsx)(o.default,{src:e.imgUser?e.imgUser:c.Z,alt:"img",width:500,height:500}),(0,t.jsxs)("div",{className:"itemCard-UserName-container ",children:[(0,t.jsxs)("div",{className:"itemCard-UserName-container-1",children:[(0,t.jsx)("h6",{className:"username-card1",children:e.username}),(0,t.jsx)("p",{children:e.cmt})]}),(0,t.jsx)("span",{className:"Time",style:{margin:"0"},children:(0,m.o0)(e.dateTime)})]})]}),localStorage.getItem("name")==e.username?(0,t.jsx)("div",{className:"itemCard-UserName-1",children:(0,t.jsx)("button",{className:"btn btn-options",onClick:e.removeClick,style:{padding:"0",margin:"0"},children:(0,t.jsx)("i",{className:"fa-solid fa-trash"})})}):null]})}},25319:function(e,a,i){"use strict";var t=i(57437),s=i(2265),l=i(9782),n=i(31213),r=i(87138),c=i(45749),m=i(66648);let d=s.memo(e=>{let[a,i]=(0,s.useState)(!1),[d,o]=(0,s.useState)(!1),u=(e,i)=>!a&&e&&e.length>i?(0,t.jsxs)(t.Fragment,{children:[e.substring(0,i),"...",(0,t.jsx)("span",{className:"see-more",onClick:()=>h(),style:{cursor:"pointer",color:"blue"},children:"xem th\xeam"})]}):e,h=()=>{i(!a)},[g,v]=(0,s.useState)(!1),[x,j]=(0,s.useState)(""),f=a=>{e.onChangeHandle&&e.onChangeHandle(a)};return(0,t.jsxs)("div",{className:"itemCard-container-dashboard",onClick:e.cardClick,onMouseEnter:e.cardClick,children:[(0,t.jsxs)("div",{className:"itemCard-UserName",children:[(0,t.jsxs)("div",{className:"itemCard-UserName-1",children:[(0,t.jsx)(r.default,{href:"/".concat(e.userKey),children:(0,t.jsx)(m.default,{src:e.imgUser?e.imgUser:c.Z,alt:"img",width:50,height:50})}),(0,t.jsxs)("div",{className:"itemCard-UserName-container cambria",children:[(0,t.jsx)("h4",{className:"username-card",children:e.username}),(0,t.jsx)("p",{style:{margin:"0"},children:(e=>{if(!e)return"";try{let a=new Date(e);return(0,l.WU)(a,"h:mm a, dd 'Th\xe1ng' MM, yyyy",{locale:n.vi})}catch(a){return console.error("Invalid date format:",e),e}})(e.dateTime)})]})]}),(()=>{let a=localStorage.getItem("name");return e.username==a?(0,t.jsx)("div",{className:"itemCard-UserName-1",children:(0,t.jsx)("button",{className:"btn btn-options",onClick:e.removeClick,style:{padding:"0",margin:"0"},children:(0,t.jsx)("i",{className:"fa-solid fa-trash"})})}):null})()]}),(()=>{if(e.tiengTrungs){let a=Object.values(e.tiengTrungs);return a.length>0?(0,t.jsxs)("div",{className:"itemCard-baiDich",onDoubleClick:()=>o(!d),children:[a.slice(0,d?a.length:3).map((a,i)=>(0,t.jsxs)("div",{className:"textDashboard_container",children:[(0,t.jsx)("pre",{className:"tiengTrung_Dashboard simsun",children:a.value}),(0,t.jsx)("pre",{className:"dichNghia_Dashboard cambria",children:e.dichNghias[i]?e.dichNghias[i].value:null})]},i)),!d&&a.length>3&&(0,t.jsx)("span",{className:"see-more",onClick:()=>o(!0),style:{cursor:"pointer",color:"blue"},children:"...xem th\xeam"})]}):null}if(e.baidich)return(0,t.jsx)("div",{className:"itemCard-baiDich",children:e.img?(0,t.jsx)("pre",{onDoubleClick:()=>h(),children:u(e.baidich,300)}):(0,t.jsx)("pre",{children:e.baidich})})})(),e.img&&(0,t.jsx)(r.default,{href:e.link,passHref:!0,legacyBehavior:!0,children:(0,t.jsx)("a",{className:"itemCard-title-dashboard",onClick:e.cardClick,children:(0,t.jsx)(m.default,{src:e.img,alt:"null",width:500,height:500})})}),(0,t.jsxs)("div",{className:"itemCard-content",children:[e.img&&(0,t.jsx)("h3",{className:"itemCard-content-title cambria",children:e.title}),e.img&&(0,t.jsx)("div",{className:"itemCard-content-description simsun",children:(0,t.jsx)("span",{children:e.tieudeTiengTrung})}),(0,t.jsxs)("div",{className:"ItemCard-dashboard-footer",children:[(0,t.jsxs)("div",{className:"ItemCard-interact",children:[(0,t.jsxs)("div",{className:"ItemCard-interact-likeview",children:[(0,t.jsx)("div",{className:"liked-view",children:(0,t.jsx)("i",{className:"fa-solid fa-thumbs-up"})}),(0,t.jsx)("span",{className:"ItemCard-interact-liked",children:(0,t.jsx)("div",{children:e.likes})})]}),(0,t.jsx)("hr",{}),localStorage.getItem("name")?(0,t.jsxs)("div",{className:"row ItemCard-interact-container",children:[(0,t.jsx)("div",{className:"col-6",onClick:()=>{v(!g),e.likeClick()},children:(0,t.jsx)("div",{className:"ItemCard-interact-item",children:(0,t.jsxs)("div",{className:"ItemCard-interact-item-flex ".concat(e.isLiked?"liked":""),children:[(0,t.jsx)("i",{className:"fa-regular fa-thumbs-up ".concat(e.isLiked?"liked-icon":"")}),(0,t.jsx)("span",{children:"Th\xedch"})]})})}),(0,t.jsx)("div",{className:"col-6",onClick:e.cmtClick,children:(0,t.jsx)("div",{className:"ItemCard-interact-item",children:(0,t.jsxs)("div",{className:"ItemCard-interact-item-flex",children:[(0,t.jsx)("i",{className:"fa-regular fa-comment"}),(0,t.jsx)("span",{children:"B\xecnh luận"})]})})})]}):null,(0,t.jsx)("hr",{})]}),(0,t.jsx)("div",{className:"itemCard-comment",children:(0,t.jsxs)("div",{className:"itemCard-comment-container",children:[(0,t.jsx)("div",{className:"itemCard-comment-viewer",children:e.comment}),(()=>{let a=localStorage.getItem("name"),i=localStorage.getItem("user"),s=JSON.parse(localStorage.getItem("allData")).find(e=>"account"===e.key).value[i];var l=c.Z;return(s&&s.img&&(l=s.img),a)?(0,t.jsxs)("div",{className:"itemCard-comment-write",children:[(0,t.jsx)("div",{className:"itemCard-user-image",children:(0,t.jsx)(m.default,{src:l,alt:"img",width:500,height:500})}),(0,t.jsxs)("div",{className:"comment-input-container",children:[(0,t.jsx)("textarea",{className:"form-control comment-input",name:e.name,"aria-describedby":"helpId",placeholder:"B\xecnh luận với vai tr\xf2 "+a,onChange:f,value:e.commentText}),(0,t.jsx)("div",{className:"itemCard-comment-send  ".concat(e.commentText?"active1":"no-item"),onClick:e.sendCmtHandle,children:(0,t.jsx)("i",{className:"fa-solid fa-paper-plane"})})]})]}):null})()]})})]})]})]})});d.displayName="ItemCardDashboard",a.Z=d},45720:function(e,a,i){"use strict";var t=i(57437),s=i(2265);a.Z=e=>{let{likes:a}=e,[i,l]=(0,s.useState)(!1),[n,r]=(0,s.useState)(!1);(0,s.useEffect)(()=>{m()});let c=localStorage.getItem("name"),m=()=>{a&&a.map(e=>{e.username===c&&r(!0)})};return(0,t.jsxs)("div",{className:"likeView-controller",children:[(0,t.jsx)("div",{className:"likeView-header",onClick:()=>{l(!i)},children:a[0]?(n?"Bạn":a[0].username)+(a[1]?" v\xe0 "+(a.length-1)+" người kh\xe1c":""):null}),(0,t.jsx)("div",{className:i?"likeView-detailes":"hidden",children:a&&a.map((e,a)=>(0,t.jsx)("div",{className:"liked-user",children:(0,t.jsx)("span",{children:e.username})},a))})]})}}},function(e){e.O(0,[2866,9513,5527,4358,7481,9208,9461,8765,4974,3539,8472,609,6901,6802,8551,2971,7023,1744],function(){return e(e.s=89693)}),_N_E=e.O()}]);