(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[157],{9693:function(e,a,t){Promise.resolve().then(t.bind(t,4456))},4456:function(e,a,t){"use strict";t.d(a,{default:function(){return h}});var i=t(7437),l=t(2265),n=t(8708),s=t(5606),r=t(9768),c=t(5319),u=t(5749),m=t(3508),o=t(5720),d=t(6648),g=t(7138);function h(e){let{user:a}=e;var t=this;let[u,h]=(0,l.useState)({datas:null,usernames:null,dateTimes:null,tieudes:null,links:null,likes:null,comments:null,weblinks:null,tieudeTiengTrungs:null,authors:null,imgAuthors:null,baidichs:null,error:null,nav:!1,loading:!1,commentTexts:{},isLikedMap:{},flagLogin:!1,flagAdmin:!1,userData:null}),[k,f]=(0,l.useState)(!0);(0,l.useEffect)(()=>{b()},[]);let b=async()=>{let e=localStorage.getItem("user"),t=localStorage.getItem("name"),i=JSON.parse(localStorage.getItem("allData"));if(!i)return;let l=i.find(e=>"dashboard"===e.key),n=i.find(e=>"account"===e.key),s=n.value[a];var r=Object.entries(l.value).map(e=>{let[a,t]=e;return{key:a,value:t}}),c=Object.entries(n.value).map(e=>{let[a,t]=e;return{key:a,value:t}});try{let a=await Promise.all(r.map(async a=>{let t=a.key,i=Object.entries(a.value).map(e=>{let[a,t]=e;return{key:a,value:t}}),l=await Promise.all(i.map(async a=>{let i="".concat(t,"&").concat(a.key);var l=a.value.comment?Object.entries(a.value.comment).map(e=>{let[a,t]=e;return{key:a,value:t}}):null,n=a.value.like?Object.entries(a.value.like).map(e=>{let[a,t]=e;return{key:a,value:t}}):null,s=a.value.tiengTrung?Object.entries(a.value.tiengTrung).map(e=>{let[a,t]=e;return{key:a,value:t}}):null,r=a.value.dichNghia?Object.entries(a.value.dichNghia).map(e=>{let[a,t]=e;return{key:a,value:t}}):null;let u=c.find(e=>e.key===t),[m,o,d,g,h,v,k,f,b,y,T,x,j,p,N]=await Promise.all([l,n,u.value.name,u.value.img,a.value.tieude,a.value.tieudeTiengTrung,a.value.author,a.value.imgAuthor,a.value.link,a.value.weblink,a.value.dateTime,a.value.id,a.value.baidich,s,r]),w=null,I=null,K=!1;return m&&(w=await Promise.all(m.map(async e=>{let a=m.find(a=>a.key===e.key),t=a.value.user,i=c.find(e=>e.key===t),[l,n,s,r]=await Promise.all([i.value.name,i.value.img,a.value.cmt,a.value.dateTime]);return{username:l,userImage:n,cmt:s,dateTime:r,id:e.key}}))),o&&(I=await Promise.all(o.map(async a=>{let t=o.find(e=>e.key===a.key);a.key===e&&(K=!0);let[i,l]=await Promise.all([t.value.name,t.value.image]);return{username:i,userImage:l}}))),{baivietKey:i,username:d,userImage:g,tieude:h,tieudeTiengTrung:v,author:k,imgAuthor:f,link:b,weblink:y,dateTime:T,comment:w,likes:I,id:x,baidich:j,isLiked:K,tiengTrungs:p,dichNghias:N}}));return{key:t,baivietDatas:l}})),i=[];a.forEach(e=>{i=i.concat(e.baivietDatas)}),i.sort((e,a)=>new Date(a.dateTime)-new Date(e.dateTime));let l={},n={},u={},m={},o={},d={},g={},v={},k={},f={},b={},y={},T={},x={},j={},p={};i.forEach(e=>{l[e.baivietKey]=e.weblink,n[e.baivietKey]=e.tieudeTiengTrung,u[e.baivietKey]=e.author,m[e.baivietKey]=e.link,o[e.baivietKey]=e.imgAuthor,d[e.baivietKey]=e.username,v[e.baivietKey]=e.tieude,g[e.baivietKey]=e.dateTime,k[e.baivietKey]=e.comment,f[e.baivietKey]=e.likes,b[e.baivietKey]=e.id,y[e.baivietKey]=e.userImage,T[e.baivietKey]=e.baidich,x[e.baivietKey]=e.isLiked,j[e.baivietKey]=e.tiengTrungs,p[e.baivietKey]=e.dichNghias});let N=i;h(a=>({...a,datas:N,myUser:e,MyUserName:t,baidichs:T,weblinks:l,tieudeTiengTrungs:n,authors:u,imgAuthors:o,links:m,usernames:d,userImages:y,tieudes:v,dateTimes:g,comments:k,likes:f,ids:b,isLikedMap:x,loading:!1,tiengTrungs:j,dichNghias:p,userData:s}))}catch(e){this.setState({error:e,loading:!1}),console.error("Error fetching data:",e)}},y=async function(e,a){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(await (0,s.Z6)(e),i){let i=e.split("/").pop();t.setState(e=>({comments:{...e.comments,[a]:e.comments[a].filter(e=>e.id!==i)}}))}else h(e=>({datas:e.datas.filter(e=>e.baivietKey!==a),baidichs:T(e.baidichs,a),weblinks:T(e.weblinks,a),tieudeTiengTrungs:T(e.tieudeTiengTrungs,a),authors:T(e.authors,a),imgAuthors:T(e.imgAuthors,a),links:T(e.links,a),usernames:T(e.usernames,a),userImages:T(e.userImages,a),tieudes:T(e.tieudes,a),dateTimes:T(e.dateTimes,a),comments:T(e.comments,a),likes:T(e.likes,a),ids:T(e.ids,a),tiengTrungs:T(e.tiengTrungs,a),dichNghias:T(e.dichNghias,a)}))},T=(e,a)=>{let{[a]:t,...i}=e;return i},x=async(e,a)=>{let t=this.state.commentTexts[a],i=localStorage.getItem("user"),l=localStorage.getItem("name"),n=localStorage.getItem("userImage");if(i){let r="".concat(e,"/comment"),c=await (0,s.UD)(r),u=new Date().toISOString(),o=null;o=c?c.length+1:1;let d="".concat(o,"-").concat((0,m.o)(u));await (0,s.Pf)("".concat(r,"/").concat(d,"/user"),i),await (0,s.Pf)("".concat(r,"/").concat(d,"/cmt"),t),await (0,s.Pf)("".concat(r,"/").concat(d,"/dateTime"),u);let g={username:l,userImage:n,cmt:t,dateTime:u,id:d};h(e=>({comments:{...e.comments,[a]:[...e.comments[a]||[],g]},commentTexts:{...e.commentTexts,[a]:""}}))}},j=async(e,a,t)=>{let i=localStorage.getItem("user"),l=localStorage.getItem("name"),n=localStorage.getItem("userImage");if(i){let r="".concat(e,"/like");if(t)await (0,s.Z6)("".concat(r,"/").concat(i)),h(e=>({likes:{...e.likes,[a]:e.likes[a].filter(e=>e.username!==l)},isLikedMap:{...e.isLikedMap,[a]:!1}}));else{await (0,s.Pf)("".concat(r,"/").concat(i,"/name"),l),await (0,s.Pf)("".concat(r,"/").concat(i,"/image"),n);let e={username:l,userImage:n};h(t=>({likes:{...t.likes,[a]:[...t.likes[a]||[],e]},isLikedMap:{...t.isLikedMap,[a]:!0}}))}}},p=(e,a)=>{h(t=>({commentTexts:{...t.commentTexts,[e]:a.target.value}}))},N=(e,a,t)=>(0,i.jsx)("div",{children:a&&a.map((a,l)=>(0,i.jsx)(v,{imgUser:a.userImage,username:a.username,cmt:a.cmt,dateTime:a.dateTime,removeClick:()=>y("".concat(e,"/comment/").concat(a.id),t,!0)},l))});return(0,i.jsx)(n.Z,{body:(0,i.jsxs)("div",{className:"container",children:[(()=>{let{userData:e}=u;if(console.log(e),e)return(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"userDataContainer",children:[(0,i.jsx)("div",{className:"userDataImage",children:e.img&&(0,i.jsx)(g.default,{href:"",passHref:!0,legacyBehavior:!0,children:(0,i.jsx)(d.default,{src:e.img,alt:"null",width:300,height:300})})}),(0,i.jsxs)("div",{className:"userDataInfo",children:[(0,i.jsx)("h3",{children:e.name}),(0,i.jsx)("br",{}),(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,i.jsx)("i",{className:"nav-icon fa-solid fa-user-pen"}),(0,i.jsx)(g.default,{href:"",passHref:!0,legacyBehavior:!0,children:"Chỉnh sửa trang c\xe1 nh\xe2n"})]})]})]}),(0,i.jsx)("hr",{})]})})(),(()=>{let{datas:e,baidichs:t,userImages:l,usernames:n,commentTexts:s,likes:r,dateTimes:m,comments:d,tieudes:g,tieudeTiengTrungs:h,ids:v,isLikedMap:k,tiengTrungs:f,dichNghias:b}=u;return e&&e.length>0?e.map((e,u)=>{let T=e.baivietKey,w=T.split("&")[0];if(w!=a)return null;let I="/users/dashboard/".concat(w,"/").concat(T.split("&")[1]);return(0,i.jsx)(c.Z,{username:n[T]||null,dateTime:m[T]||null,imgUser:l[T]||null,comment:d[T]?N(I,d[T],T):null,likes:r[T]?(0,i.jsx)(o.Z,{likes:r[T]}):null,tieudeTiengTrung:h[T]||null,link:T?"/dashboard/".concat(w,"/").concat(T.split("&")[1]):null,title:g[T]||null,baidich:t[T]||null,img:v[T]?"https://img.youtube.com/vi/".concat(v[T],"/sddefault.jpg"):null,removeClick:()=>y(I,T,!1),sendCmtHandle:()=>x(I,T),commentText:s[T]||"",onChangeHandle:e=>p(T,e),likeClick:()=>j(I,T,k[T]),isLiked:k[T],tiengTrungs:f[T]||null,dichNghias:b[T]||null},u)}):null})(),u.loading?(0,i.jsx)(r.Z,{}):null]})})}function v(e){return(0,i.jsxs)("div",{className:"itemCard-UserName",children:[(0,i.jsxs)("div",{className:"itemCard-UserName-2",children:[(0,i.jsx)(d.default,{src:e.imgUser?e.imgUser:u.Z,alt:"img",width:500,height:500}),(0,i.jsxs)("div",{className:"itemCard-UserName-container ",children:[(0,i.jsxs)("div",{className:"itemCard-UserName-container-1",children:[(0,i.jsx)("h6",{className:"username-card1",children:e.username}),(0,i.jsx)("p",{children:e.cmt})]}),(0,i.jsx)("span",{className:"Time",style:{margin:"0"},children:(0,m.o)(e.dateTime)})]})]}),localStorage.getItem("name")==e.username?(0,i.jsx)("div",{className:"itemCard-UserName-1",children:(0,i.jsx)("button",{className:"btn btn-options",onClick:e.removeClick,style:{padding:"0",margin:"0"},children:(0,i.jsx)("i",{className:"fa-solid fa-trash"})})}):null]})}}},function(e){e.O(0,[481,461,630,648,609,708,669,971,23,560],function(){return e(e.s=9693)}),_N_E=e.O()}]);