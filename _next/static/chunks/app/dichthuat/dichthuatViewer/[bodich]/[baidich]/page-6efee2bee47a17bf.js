(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[794],{923:function(e,i,t){Promise.resolve().then(t.bind(t,4278))},4278:function(e,i,t){"use strict";t.d(i,{default:function(){return m}});var n=t(7437),a=t(2265),l=t(8708),c=t(35),s=t(4379),r=t.n(s),o=t(5606),u=t(8833),h=t(1795),d=t(9768);function m(e){let{bodich:i,baidich:t}=e,[s,m]=(0,a.useState)({dichthuat:null,youtubeLink:null,webLink:null,tieude:null,tieudeTiengTrung:null,author:null,imgAuthor:null,id:null,error:null,nav:!1,tuMois:{},tuMoiNghias:{},tuMoiNghiaGets:{},tuMoiPinyins:{},tumoiViduGets:{},tuMoiVidus:{},tuMoiViduDichs:{},tuMoiViduPinyins:{},hanviets:{},baiDich:null,tiengTrungs:{},dichNghias:{},BaidichData:{},user:null,allData:null}),[g,v]=(0,a.useState)(!0),[y,j]=(0,a.useState)(!1),f=(0,a.useRef)(null),p=(0,a.useRef)(null),[k,x]=(0,a.useState)({}),[b,N]=(0,a.useState)({}),[w,P]=(0,a.useState)([]);(0,a.useEffect)(()=>{S();let e=document.querySelectorAll(".phanDich textarea");return e.forEach(e=>{e.addEventListener("input",function(){this.style.height="auto",this.style.height=this.scrollHeight+"px"})}),()=>{e.forEach(e=>{e.removeEventListener("input",function(){this.style.height="auto",this.style.height=this.scrollHeight+"px"})})}},[]);let T=async()=>{v(!0);let e=localStorage.getItem("user"),i=localStorage.getItem("name"),n=localStorage.getItem("userImage"),a="/users/dashboard/".concat(e,"/").concat(t),l="".concat(a,"/tiengTrung"),c="".concat(a,"/noidung"),u="".concat(a,"/dichNghia"),{BaidichData:h,tieude:d,tiengTrungs:g,dichNghias:y,youtubeLink:j,webLink:f,tieudeTiengTrung:p,author:k,imgAuthor:x,embedLink:b}=s,N=new Date().toISOString(),w=Object.values(y).filter(e=>null!==e),P=h&&h.noidung&&Object.values(h.noidung).filter(e=>null!==e),T=Object.values(g);try{let e=L(j);await Promise.all([(0,o.Pf)("".concat(a,"/username"),i),(0,o.Pf)("".concat(a,"/weblink"),j),(0,o.Pf)("".concat(a,"/tieudeTiengTrung"),p),(0,o.Pf)("".concat(a,"/tieude"),d),(0,o.Pf)("".concat(a,"/link"),b),(0,o.Pf)("".concat(a,"/author"),k),(0,o.Pf)("".concat(a,"/imgAuthor"),x),(0,o.Pf)("".concat(a,"/dateTime"),N),(0,o.Pf)("".concat(a,"/id"),e),(0,o.Pf)("".concat(a,"/userImage"),n)]),await Promise.all(w.map((e,i)=>{let t="".concat(u,"/").concat(i);(0,o.Pf)(t,e)})),await Promise.all(T.map((e,i)=>{let t="".concat(l,"/").concat(i);(0,o.Pf)(t,e)})),await Promise.all(P.map((e,i)=>{let t="".concat(c,"/").concat(i,"/hanviet"),n="".concat(c,"/").concat(i,"/pinyin"),a="".concat(c,"/").concat(i,"/tiengtrung");(0,o.Pf)(t,e.hanviet),(0,o.Pf)(n,e.pinyin),(0,o.Pf)(a,e.tiengTrung)})),v(!1),await r().fire({position:"center",icon:"success",title:"Đăng b\xe0i th\xe0nh c\xf4ng",showConfirmButton:!1,timer:1500}),m(e=>({...e,nav:!0}))}catch(i){console.error("Lỗi tạo b\xe0i mới:",i);let e={message:"Lỗi tạo b\xe0i mới: "+i.message};r().fire(i.message,"","info"),m(i=>({...i,error:e}))}finally{v(!1)}},S=async()=>{let e=localStorage.getItem("user");v(!0);let n=JSON.parse(localStorage.getItem("allData")),a=n.find(e=>"dichthuat"===e.key),l=a.value[i],c=a.value[i].listBaihoc[t],s=a.value[i].listBaihoc[t][e];var r=null,o=null;s&&(r=s.tumoi?Object.entries(s.tumoi).map(e=>{let[i,t]=e;return{key:i,value:t}}):null,o=s.baidich?Object.entries(s.baidich).map(e=>{let[i,t]=e;return{key:i,value:t}}):null);let u=c.noidung?Object.entries(c.noidung).map(e=>{let[i,t]=e;return{key:i,value:t}}):null,h="/users/dichthuat/".concat(i,"/listBaihoc/").concat(t);"".concat(h,"/").concat(e,"/baidich"),"".concat(h,"/").concat(e,"/tumoi");let[d,g,y,j,f,p,k,x,b]=await Promise.all([r,c.tieude,c.link,c.weblink,c.tieudeTiengTrung,l.author,l.imgAuthor,o,u]),N=y?"https://www.youtube.com/embed/".concat(L(y)):null,w={},P={},T={},S={},C={},O={},I={},B={};d&&await Promise.all(d.map(async(e,i)=>{let t=d.find(i=>i.key===e.key);w[e.key]=Object.entries(t.value.nghia).map(e=>{let[i,t]=e;return{key:i,value:t}}),T[e.key]=t.value.pinyin,B[e.key]=t.value.hanviet,w[e.key]&&await Promise.all(w[e.key].map(async(i,t)=>{let n=s.tumoi[e.key].nghia[i.key];P[i.key]=n.nghia,S[i.key]=n.vidu?await Object.entries(n.vidu).map(e=>{let[i,t]=e;return{key:i,value:t}}):null,S[i.key]&&await Promise.all(S[i.key].map(async e=>{O[e.key]=n.vidu[e.key].nghia,C[e.key]=n.vidu[e.key].vidu,I[e.key]=n.vidu[e.key].pinyin}))}))}));let E={},V={};b&&await Promise.all(b.map(async e=>{c.noidung[e.key]&&(E[e.key]=c.noidung[e.key].tiengTrung)})),x&&await Promise.all(x.map(async e=>{x[e.key]&&(V[e.key]=x[e.key].value)})),m(i=>({...i,webLink:j,tieudeTiengTrung:f,tieude:g,author:p,imgAuthor:k,youtubeLink:y,noiDungBaiDich:b,user:e,tuMoiNghias:P,tuMoiNghiaGets:w,tuMoiPinyins:T,tuMoiViduPinyins:I,tumoiViduGets:S,tuMoiVidus:C,tuMoiViduDichs:O,tuMois:d,baiDich:x,embedLink:N,hanviets:B,tiengTrungs:E,dichNghias:V,user:e,allData:n,BaidichData:c})),v(!1)},C=async()=>{v(!0);let{baiDich:e,dichNghias:n={}}=s,a=localStorage.getItem("user"),l="/users/dichthuat/".concat(i,"/listBaihoc/").concat(t,"/").concat(a,"/baidich");try{let e=Object.values(n).filter(e=>null!==e);if(!e.length)throw Error("No valid dichNghias to save.");await Promise.all(e.map((e,i)=>{let t="".concat(l,"/").concat(i);return(0,o.Pf)(t,e)})),await r().fire({position:"center",icon:"success",title:"Tạo b\xe0i mới th\xe0nh c\xf4ng",showConfirmButton:!1,timer:1500})}catch(e){v(!1),console.error("Lỗi tạo b\xe0i mới:",e),await r().fire("Lỗi tạo b\xe0i mới: "+e.message,"","info")}finally{v(!1)}},O=(e,i)=>e.split(RegExp("(".concat(i,")"),"gi")).map((e,t)=>e.toLowerCase()===i.toLowerCase()?(0,n.jsx)("span",{style:{color:"red"},children:e},t):e),L=e=>{var i=e.split("=");return i[1]?i[1].split("&")[0]:"null"},I=()=>{p.current&&p.current.scrollIntoView({behavior:"smooth"})},B=e=>{N({...b,[e]:!b[e]})},E=(e,i)=>{x({...k,[e+"-"+i]:!0})},V=(e,i)=>{x({...k,[e+"-"+i]:!1})},Z=(e,i)=>{m(t=>({...t,dichNghias:{...t.dichNghias,[i]:e.target.value}}))},D=e=>{P(i=>{let t=[...i];return t[e]=!t[e],t})},{tieude:M,baiDich:_,webLink:A,tieudeTiengTrung:H,author:R,imgAuthor:G,embedLink:q,noiDungBaiDich:J,tiengTrungs:z,dichNghias:F}=s;return(0,n.jsx)(l.Z,{body:(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"dichthuat-container row",ref:p,children:[(0,n.jsxs)("div",{className:"col-5",children:[(0,n.jsx)("div",{children:(0,n.jsx)(u.Z,{videoLink:q||null,webLink:A||null,tieudeTiengTrung:H||null,author:R||null,imgAuthor:G||null,title:M||null})}),(0,n.jsxs)("div",{style:{display:"flex"},children:[(0,n.jsx)(c.Z,{className:"button-css",variant:"info",onClick:C,children:"Lưu b\xe0i dịch"}),(0,n.jsx)(c.Z,{className:"button-css",variant:"danger",onClick:T,children:"Đăng b\xe0i"})]})]}),(0,n.jsx)("div",{className:"col",children:(0,n.jsx)("div",{className:"card border-primary cardPhandich",children:(0,n.jsxs)("div",{className:"card-body",children:[(0,n.jsx)("div",{className:"",style:{display:"flex",justifyContent:"space-between",marginBottom:"10px"},children:(0,n.jsx)("h4",{className:"card-title",children:"Phần Dịch"})}),(()=>{let{BaidichData:e,tiengTrungs:i,dichNghias:t=[]}=s;return(Object.values(i),e&&e.noidung)?(0,n.jsx)("div",{className:"showNguyenVan",children:e.noidung.map((e,i)=>e&&(0,n.jsxs)("div",{className:"phanDich",children:[(0,n.jsx)("div",{className:"tiengTrung",onClick:()=>D(i),children:e.tiengTrung||""}),e.pinyin&&w[i]&&(0,n.jsx)("div",{className:"showNguyenVan-pinyin",children:e.pinyin||""}),e.hanviet&&w[i]&&(0,n.jsx)("div",{className:"showNguyenVan-hanviet",children:e.hanviet||""}),(0,n.jsx)("textarea",{value:t[i-1]||"",onChange:e=>Z(e,i-1),placeholder:"Nhập b\xe0i dịch của bạn"}),(0,n.jsx)("hr",{})]},i))}):null})()]})})})]}),(0,n.jsxs)("div",{className:"tumoi-area",children:[(0,n.jsxs)("div",{className:"tumoi-area-header",children:[(0,n.jsx)("h2",{className:"card-title",children:"Từ mới"}),(0,n.jsx)(c.Z,{variant:"info",onClick:()=>{j(!y),f.current&&f.current.scrollIntoView({behavior:"smooth"})},children:"Th\xeam từ mới"})]}),(0,n.jsxs)("div",{className:"row",children:[(0,n.jsx)("div",{className:"col",children:(0,n.jsxs)("div",{className:"tumoi-container",children:[(0,n.jsx)("div",{className:"tumoi-header"}),(()=>{let{user:e,allData:a,tuMois:l,tuMoiNghias:r,tuMoiNghiaGets:o,tuMoiPinyins:u,tumoiViduGets:h,tuMoiVidus:d,tuMoiViduDichs:m,tuMoiViduPinyins:g,hanviets:v}=s;return a&&(a.find(e=>"dichthuat"===e.key).value[i].listBaihoc[t][e],l&&l.length>0)?l.map((e,i)=>{let t=e.value.nghia,a=e.value.pinyin,l=e.value.hanviet,s=b[e.key];return(0,n.jsx)("div",{className:"tumoi-item",children:(0,n.jsxs)("div",{className:"tumoi-display",children:[(0,n.jsxs)("div",{className:"tumoi-display-header",children:[(0,n.jsxs)("h4",{children:[i+1,", ",e.key,"  【",l,"】(",a,")"]}),(0,n.jsx)(c.Z,{variant:s?"danger":"warning",onClick:()=>B(e.key),children:s?"Ẩn bớt nghĩa của từ":"Hiển thị nghĩa của từ"})]}),s&&t&&t.map((i,t)=>{let a=i.vidu?i.vidu:null,l=i.nghia,s=k[e.key+"-"+i.key];return(0,n.jsxs)("div",{className:"tumoi-nghia",children:[(0,n.jsxs)("h4",{className:"tumoi-nghia-shower",children:["Nghĩa ",t+1,": ",l]}),a&&a.map((i,t)=>{let a=i.vidu,l=i.nghia,c=i.pinyin;return s||0===t?(0,n.jsxs)("div",{className:"tumoi-vidu",children:[(0,n.jsxs)("h5",{children:["V\xed dụ ",t+1]}),(0,n.jsx)("p",{children:O(a,e.key)}),(0,n.jsx)("p",{children:c}),(0,n.jsx)("p",{children:l})]},t):null}),s?(0,n.jsx)(c.Z,{variant:"warning",onClick:()=>V(e.key,nghia.key),children:"Ẩn bớt v\xed dụ"}):(0,n.jsx)(c.Z,{variant:"info",onClick:()=>E(e.key,nghia.key),children:"Hiển thị th\xeam v\xed dụ"}),(0,n.jsx)("hr",{})]},t)})]})},i)}):null})()]})}),(0,n.jsx)("div",{ref:f,children:(0,n.jsx)(h.Z,{scrollBaidich:()=>I(),bodich:i,baidich:t})})]})]}),g?(0,n.jsx)(d.Z,{}):null]})})}}},function(e){e.O(0,[481,461,630,648,439,708,151,971,23,560],function(){return e(e.s=923)}),_N_E=e.O()}]);