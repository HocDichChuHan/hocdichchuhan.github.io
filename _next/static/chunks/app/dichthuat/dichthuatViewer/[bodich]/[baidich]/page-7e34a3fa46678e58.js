(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[794],{923:function(e,i,a){Promise.resolve().then(a.bind(a,4278))},4278:function(e,i,a){"use strict";a.d(i,{default:function(){return m}});var t=a(7437),n=a(2265),l=a(8708),s=a(35),c=a(4379),r=a.n(c),o=a(5606),u=a(8833),d=a(1795),h=a(9768);function m(e){let{bodich:i,baidich:a}=e,[c,m]=(0,n.useState)({dichthuat:null,youtubeLink:null,webLink:null,tieude:null,tieudeTiengTrung:null,author:null,imgAuthor:null,id:null,error:null,nav:!1,tuMois:{},tuMoiNghias:{},tuMoiNghiaGets:{},tuMoiPinyins:{},tumoiViduGets:{},tuMoiVidus:{},tuMoiViduDichs:{},tuMoiViduPinyins:{},hanviets:{},baiDich:null,tiengTrungs:{},dichNghias:{},user:null,allData:null}),[y,g]=(0,n.useState)(!0),[k,v]=(0,n.useState)(!1),j=(0,n.useRef)(null),f=(0,n.useRef)(null),[x,p]=(0,n.useState)({}),[b,w]=(0,n.useState)({});(0,n.useEffect)(()=>{P()},[]);let N=async()=>{g(!0);let e=localStorage.getItem("user"),i=localStorage.getItem("name"),t=localStorage.getItem("userImage"),n="/users/dashboard/".concat(e,"/").concat(a),l="".concat(n,"/tiengTrung"),s="".concat(n,"/dichNghia"),{tieude:u,tiengTrungs:d,dichNghias:h,youtubeLink:y,webLink:k,tieudeTiengTrung:v,author:j,imgAuthor:f,embedLink:x}=c,p=new Date().toISOString(),b=Object.values(h).filter(e=>null!==e),w=Object.values(d);try{let e=O(y);await Promise.all([(0,o.Pf)("".concat(n,"/username"),i),(0,o.Pf)("".concat(n,"/weblink"),y),(0,o.Pf)("".concat(n,"/tieudeTiengTrung"),v),(0,o.Pf)("".concat(n,"/tieude"),u),(0,o.Pf)("".concat(n,"/link"),x),(0,o.Pf)("".concat(n,"/author"),j),(0,o.Pf)("".concat(n,"/imgAuthor"),f),(0,o.Pf)("".concat(n,"/dateTime"),p),(0,o.Pf)("".concat(n,"/id"),e),(0,o.Pf)("".concat(n,"/userImage"),t)]),await Promise.all(b.map((e,i)=>{let a="".concat(s,"/").concat(i);(0,o.Pf)(a,e)})),await Promise.all(w.map((e,i)=>{let a="".concat(l,"/").concat(i);(0,o.Pf)(a,e)})),await r().fire({position:"center",icon:"success",title:"Đăng b\xe0i th\xe0nh c\xf4ng",showConfirmButton:!1,timer:1500}),m(e=>({...e,nav:!0}))}catch(i){console.error("Lỗi tạo b\xe0i mới:",i);let e={message:"Lỗi tạo b\xe0i mới: "+i.message};r().fire(i.message,"","info"),m(i=>({...i,error:e}))}finally{g(!1)}},P=async()=>{let e=localStorage.getItem("user");g(!0);let t=JSON.parse(localStorage.getItem("allData")),n=t.find(e=>"dichthuat"===e.key),l=n.value[i],s=n.value[i].listBaihoc[a],c=n.value[i].listBaihoc[a][e];var r=null,o=null;c&&(r=c.tumoi?Object.entries(c.tumoi).map(e=>{let[i,a]=e;return{key:i,value:a}}):null,o=c.baidich?Object.entries(c.baidich).map(e=>{let[i,a]=e;return{key:i,value:a}}):null);let u=s.noidung?Object.entries(s.noidung).map(e=>{let[i,a]=e;return{key:i,value:a}}):null,d="/users/dichthuat/".concat(i,"/listBaihoc/").concat(a);"".concat(d,"/").concat(e,"/baidich"),"".concat(d,"/").concat(e,"/tumoi");let[h,y,k,v,j,f,x,p,b]=await Promise.all([r,s.tieude,s.link,s.weblink,s.tieudeTiengTrung,l.author,l.imgAuthor,o,u]),w=k?"https://www.youtube.com/embed/".concat(O(k)):null,N={},P={},T={},C={},S={},I={},L={},B={};h&&await Promise.all(h.map(async(e,i)=>{let a=h.find(i=>i.key===e.key);N[e.key]=Object.entries(a.value.nghia).map(e=>{let[i,a]=e;return{key:i,value:a}}),T[e.key]=a.value.pinyin,B[e.key]=a.value.hanviet,N[e.key]&&await Promise.all(N[e.key].map(async(i,a)=>{let t=c.tumoi[e.key].nghia[i.key];P[i.key]=t.nghia,C[i.key]=t.vidu?await Object.entries(t.vidu).map(e=>{let[i,a]=e;return{key:i,value:a}}):null,C[i.key]&&await Promise.all(C[i.key].map(async e=>{I[e.key]=t.vidu[e.key].nghia,S[e.key]=t.vidu[e.key].vidu,L[e.key]=t.vidu[e.key].pinyin}))}))}));let Z={},D={};b&&await Promise.all(b.map(async e=>{s.noidung[e.key]&&(Z[e.key]=s.noidung[e.key].tiengTrung)})),p&&await Promise.all(p.map(async e=>{p[e.key]&&(D[e.key]=p[e.key].value)})),m(i=>({...i,webLink:v,tieudeTiengTrung:j,tieude:y,author:f,imgAuthor:x,youtubeLink:k,noiDungBaiDich:b,user:e,tuMoiNghias:P,tuMoiNghiaGets:N,tuMoiPinyins:T,tuMoiViduPinyins:L,tumoiViduGets:C,tuMoiVidus:S,tuMoiViduDichs:I,tuMois:h,baiDich:p,embedLink:w,hanviets:B,tiengTrungs:Z,dichNghias:D,user:e,allData:t})),g(!1)},T=async()=>{g(!0);let{baiDich:e,dichNghias:t={}}=c,n=localStorage.getItem("user"),l="/users/dichthuat/".concat(i,"/listBaihoc/").concat(a,"/").concat(n,"/baidich");try{let e=Object.values(t).filter(e=>null!==e);if(!e.length)throw Error("No valid dichNghias to save.");await Promise.all(e.map((e,i)=>{let a="".concat(l,"/").concat(i);return(0,o.Pf)(a,e)})),await r().fire({position:"center",icon:"success",title:"Tạo b\xe0i mới th\xe0nh c\xf4ng",showConfirmButton:!1,timer:1500})}catch(e){g(!1),console.error("Lỗi tạo b\xe0i mới:",e),await r().fire("Lỗi tạo b\xe0i mới: "+e.message,"","info")}finally{g(!1)}},C=(e,i)=>e.split(RegExp("(".concat(i,")"),"gi")).map((e,a)=>e.toLowerCase()===i.toLowerCase()?(0,t.jsx)("span",{style:{color:"red"},children:e},a):e),O=e=>{var i=e.split("=");return i[1]?i[1].split("&")[0]:"null"},S=()=>{f.current&&f.current.scrollIntoView({behavior:"smooth"})},I=e=>{w({...b,[e]:!b[e]})},L=(e,i)=>{p({...x,[e+"-"+i]:!0})},B=(e,i)=>{p({...x,[e+"-"+i]:!1})},Z=(e,i)=>{m(a=>({...a,dichNghias:{...a.dichNghias,[i]:e.target.value}}))},{tieude:D,baiDich:M,webLink:V,tieudeTiengTrung:E,author:_,imgAuthor:A,embedLink:R,noiDungBaiDich:G,tiengTrungs:H,dichNghias:J}=c;return(0,t.jsx)(l.Z,{body:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"dichthuat-container row",ref:f,children:[(0,t.jsxs)("div",{className:"col-5",children:[(0,t.jsx)("div",{children:(0,t.jsx)(u.Z,{videoLink:R||null,webLink:V||null,tieudeTiengTrung:E||null,author:_||null,imgAuthor:A||null,title:D||null})}),(0,t.jsxs)("div",{style:{display:"flex"},children:[(0,t.jsx)(s.Z,{className:"button-css",variant:"info",onClick:T,children:"Lưu b\xe0i dịch"}),(0,t.jsx)(s.Z,{className:"button-css",variant:"danger",onClick:N,children:"Đăng b\xe0i"})]})]}),(0,t.jsx)("div",{className:"col",children:(0,t.jsx)("div",{className:"card border-primary cardPhandich",children:(0,t.jsxs)("div",{className:"card-body",children:[(0,t.jsx)("div",{className:"",style:{display:"flex",justifyContent:"space-between",marginBottom:"10px"},children:(0,t.jsx)("h4",{className:"card-title",children:"Phần Dịch"})}),(()=>{let{tiengTrungs:e,dichNghias:i=[]}=c,a=Object.values(e);return a&&a.length>0?(0,t.jsx)("div",{className:"",children:a.map((e,a)=>(0,t.jsxs)("div",{className:"phanDich",children:[(0,t.jsx)("div",{children:e||""}),(0,t.jsx)("textarea",{value:i[a]||"",onChange:e=>Z(e,a),placeholder:"Nhập b\xe0i dịch của bạn"}),(0,t.jsx)("hr",{})]},a))}):null})()]})})})]}),(0,t.jsxs)("div",{className:"tumoi-area",children:[(0,t.jsxs)("div",{className:"tumoi-area-header",children:[(0,t.jsx)("h2",{className:"card-title",children:"Từ mới"}),(0,t.jsx)(s.Z,{variant:"info",onClick:()=>{v(!k),j.current&&j.current.scrollIntoView({behavior:"smooth"})},children:"Th\xeam từ mới"})]}),(0,t.jsxs)("div",{className:"row",children:[(0,t.jsx)("div",{className:"col",children:(0,t.jsxs)("div",{className:"tumoi-container",children:[(0,t.jsx)("div",{className:"tumoi-header"}),(()=>{let{user:e,allData:n,tuMois:l,tuMoiNghias:r,tuMoiNghiaGets:o,tuMoiPinyins:u,tumoiViduGets:d,tuMoiVidus:h,tuMoiViduDichs:m,tuMoiViduPinyins:y,hanviets:g}=c;if(!n)return null;let k=n.find(e=>"dichthuat"===e.key).value[i].listBaihoc[a][e];return l&&l.length>0?l.map((e,i)=>{let a=o[e.key],n=u[e.key],l=g[e.key],c=b[e.key];return o[e.key]&&Promise.all(o[e.key].map(async(i,a)=>{let t=k.tumoi[e.key].nghia[i.key];r[i.key]=t.nghia,d[i.key]=t.vidu?await Object.entries(t.vidu).map(e=>{let[i,a]=e;return{key:i,value:a}}):null,d[i.key]&&await Promise.all(d[i.key].map(async e=>{m[e.key]=t.vidu[e.key].nghia,h[e.key]=t.vidu[e.key].vidu,y[e.key]=t.vidu[e.key].pinyin}))})),(0,t.jsx)("div",{className:"tumoi-item",children:(0,t.jsxs)("div",{className:"tumoi-display",children:[(0,t.jsxs)("div",{className:"tumoi-display-header",children:[(0,t.jsxs)("h4",{children:[i+1,", ",e.key,"  【",l,"】(",n,")"]}),(0,t.jsx)(s.Z,{variant:c?"danger":"warning",onClick:()=>I(e.key),children:c?"Ẩn bớt nghĩa của từ":"Hiển thị nghĩa của từ"})]}),c&&a&&a.map((i,a)=>{let n=d[i.key],l=r[i.key],c=x[e.key+"-"+i.key];return console.log(i),console.log(r),(0,t.jsxs)("div",{className:"tumoi-nghia",children:[(0,t.jsxs)("h4",{className:"tumoi-nghia-shower",children:["Nghĩa ",a+1,": ",l]}),n&&n.map((i,a)=>{let n=h[i.key],l=m[i.key],s=y[i.key];return c||0===a?(0,t.jsxs)("div",{className:"tumoi-vidu",children:[(0,t.jsxs)("h5",{children:["V\xed dụ ",a+1]}),(0,t.jsx)("p",{children:C(n,e.key)}),(0,t.jsx)("p",{children:s}),(0,t.jsx)("p",{children:l})]},a):null}),c?(0,t.jsx)(s.Z,{variant:"warning",onClick:()=>B(e.key,i.key),children:"Ẩn bớt v\xed dụ"}):(0,t.jsx)(s.Z,{variant:"info",onClick:()=>L(e.key,i.key),children:"Hiển thị th\xeam v\xed dụ"}),(0,t.jsx)("hr",{})]},a)})]})},i)}):null})()]})}),(0,t.jsx)("div",{ref:j,children:(0,t.jsx)(d.Z,{getDataTumoi:()=>P(),luuBaiDich:()=>T(),scrollBaidich:()=>S(),bodich:i,baidich:a})})]})]}),y?(0,t.jsx)(h.Z,{}):null]})})}}},function(e){e.O(0,[481,461,630,648,439,708,151,971,23,560],function(){return e(e.s=923)}),_N_E=e.O()}]);