(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7792:function(e,t,a){Promise.resolve().then(a.bind(a,1969))},1969:function(e,t,a){"use strict";a.r(t);var i=a(7437),l=a(2265),n=a(8708),s=a(5606),r=a(9768),m=a(5319),u=a(5749),c=a(3508),o=a(5720),d=a(6648);a(1656),a(594);class h extends l.Component{componentDidMount(){this.getData()}componentWillUnmount(){clearInterval(this.intervalId)}render(){return(0,i.jsx)(n.Z,{body:(0,i.jsxs)("div",{className:"container",children:[this.showBaidich(),this.state.loading?(0,i.jsx)(r.Z,{}):null]})})}constructor(e){var t;super(e),t=this,this.getData=async()=>{this.setState({loading:!0});let e=localStorage.getItem("user"),t=localStorage.getItem("name"),a=JSON.parse(localStorage.getItem("allData"));if(!a)return;let i=a.find(e=>"dashboard"===e.key),l=a.find(e=>"account"===e.key);var n=Object.entries(i.value).map(e=>{let[t,a]=e;return{key:t,value:a}}),s=Object.entries(l.value).map(e=>{let[t,a]=e;return{key:t,value:a}});try{let a=await Promise.all(n.map(async t=>{let a=t.key,i=Object.entries(t.value).map(e=>{let[t,a]=e;return{key:t,value:a}}),l=await Promise.all(i.map(async t=>{let i="".concat(a,"&").concat(t.key);var l=t.value.comment?Object.entries(t.value.comment).map(e=>{let[t,a]=e;return{key:t,value:a}}):null,n=t.value.like?Object.entries(t.value.like).map(e=>{let[t,a]=e;return{key:t,value:a}}):null,r=t.value.tiengTrung?Object.entries(t.value.tiengTrung).map(e=>{let[t,a]=e;return{key:t,value:a}}):null,m=t.value.dichNghia?Object.entries(t.value.dichNghia).map(e=>{let[t,a]=e;return{key:t,value:a}}):null;let u=s.find(e=>e.key===a),[c,o,d,h,g,v,k,y,f,b,T,p,K,w,C]=await Promise.all([l,n,u.value.name,u.value.img,t.value.tieude,t.value.tieudeTiengTrung,t.value.author,t.value.imgAuthor,t.value.link,t.value.weblink,t.value.dateTime,t.value.id,t.value.baidich,r,m]),O=null,j=null,x=!1;return c&&(O=await Promise.all(c.map(async e=>{let t=c.find(t=>t.key===e.key),a=t.value.user,i=s.find(e=>e.key===a),[l,n,r,m]=await Promise.all([i.value.name,i.value.img,t.value.cmt,t.value.dateTime]);return{username:l,userImage:n,cmt:r,dateTime:m,id:e.key}}))),o&&(j=await Promise.all(o.map(async t=>{let a=o.find(e=>e.key===t.key);t.key===e&&(x=!0);let[i,l]=await Promise.all([a.value.name,a.value.image]);return{username:i,userImage:l}}))),{baivietKey:i,username:d,userImage:h,tieude:g,tieudeTiengTrung:v,author:k,imgAuthor:y,link:f,weblink:b,dateTime:T,comment:O,likes:j,id:p,baidich:K,isLiked:x,tiengTrungs:w,dichNghias:C}}));return{key:a,baivietDatas:l}})),i=[];a.forEach(e=>{i=i.concat(e.baivietDatas)}),i.sort((e,t)=>new Date(t.dateTime)-new Date(e.dateTime));let l={},r={},m={},u={},c={},o={},d={},h={},g={},v={},k={},y={},f={},b={},T={},p={};i.forEach(e=>{l[e.baivietKey]=e.weblink,r[e.baivietKey]=e.tieudeTiengTrung,m[e.baivietKey]=e.author,u[e.baivietKey]=e.link,c[e.baivietKey]=e.imgAuthor,o[e.baivietKey]=e.username,h[e.baivietKey]=e.tieude,d[e.baivietKey]=e.dateTime,g[e.baivietKey]=e.comment,v[e.baivietKey]=e.likes,k[e.baivietKey]=e.id,y[e.baivietKey]=e.userImage,f[e.baivietKey]=e.baidich,b[e.baivietKey]=e.isLiked,T[e.baivietKey]=e.tiengTrungs,p[e.baivietKey]=e.dichNghias}),this.setState({datas:i,myUser:e,MyUserName:t,baidichs:f,weblinks:l,tieudeTiengTrungs:r,authors:m,imgAuthors:c,links:u,usernames:o,userImages:y,tieudes:h,dateTimes:d,comments:g,likes:v,ids:k,isLikedMap:b,loading:!1,tiengTrungs:T,dichNghias:p})}catch(e){this.setState({error:e,loading:!1}),console.error("Error fetching data:",e)}},this.removeClick=async function(e,a){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(await (0,s.Z6)(e),i){let i=e.split("/").pop();t.setState(e=>({comments:{...e.comments,[a]:e.comments[a].filter(e=>e.id!==i)}}))}else t.setState(e=>({datas:e.datas.filter(e=>e.baivietKey!==a),baidichs:t.filterOutKey(e.baidichs,a),weblinks:t.filterOutKey(e.weblinks,a),tieudeTiengTrungs:t.filterOutKey(e.tieudeTiengTrungs,a),authors:t.filterOutKey(e.authors,a),imgAuthors:t.filterOutKey(e.imgAuthors,a),links:t.filterOutKey(e.links,a),usernames:t.filterOutKey(e.usernames,a),userImages:t.filterOutKey(e.userImages,a),tieudes:t.filterOutKey(e.tieudes,a),dateTimes:t.filterOutKey(e.dateTimes,a),comments:t.filterOutKey(e.comments,a),likes:t.filterOutKey(e.likes,a),ids:t.filterOutKey(e.ids,a),tiengTrungs:t.filterOutKey(e.tiengTrungs,a),dichNghias:t.filterOutKey(e.dichNghias,a)}))},this.filterOutKey=(e,t)=>{let{[t]:a,...i}=e;return i},this.sendCmtHandle=async(e,t)=>{let a=this.state.commentTexts[t],i=localStorage.getItem("user"),l=localStorage.getItem("name"),n=localStorage.getItem("userImage");if(i){let r="".concat(e,"/comment"),m=await (0,s.UD)(r),u=new Date().toISOString(),o=null;o=m?m.length+1:1;let d="".concat(o,"-").concat((0,c.o)(u));await (0,s.Pf)("".concat(r,"/").concat(d,"/user"),i),await (0,s.Pf)("".concat(r,"/").concat(d,"/cmt"),a),await (0,s.Pf)("".concat(r,"/").concat(d,"/dateTime"),u);let h={username:l,userImage:n,cmt:a,dateTime:u,id:d};this.setState(e=>({comments:{...e.comments,[t]:[...e.comments[t]||[],h]},commentTexts:{...e.commentTexts,[t]:""}}))}},this.likeClick=async(e,t,a)=>{let i=localStorage.getItem("user"),l=localStorage.getItem("name"),n=localStorage.getItem("userImage");if(i){let r="".concat(e,"/like");if(a)await (0,s.Z6)("".concat(r,"/").concat(i)),this.setState(e=>({likes:{...e.likes,[t]:e.likes[t].filter(e=>e.username!==l)},isLikedMap:{...e.isLikedMap,[t]:!1}}));else{await (0,s.Pf)("".concat(r,"/").concat(i,"/name"),l),await (0,s.Pf)("".concat(r,"/").concat(i,"/image"),n);let e={username:l,userImage:n};this.setState(a=>({likes:{...a.likes,[t]:[...a.likes[t]||[],e]},isLikedMap:{...a.isLikedMap,[t]:!0}}))}}},this.handleCommentChange=(e,t)=>{this.setState(a=>({commentTexts:{...a.commentTexts,[e]:t.target.value}}))},this.showBaidich=()=>{let{datas:e,baidichs:t,userImages:a,usernames:l,commentTexts:n,likes:s,dateTimes:r,comments:u,tieudes:c,tieudeTiengTrungs:d,ids:h,isLikedMap:g,tiengTrungs:v,dichNghias:k}=this.state;return e&&e.length>0?e.map((e,y)=>{let f=e.baivietKey,b=f.split("&")[0],T="/users/dashboard/".concat(b,"/").concat(f.split("&")[1]);return(0,i.jsx)(m.Z,{username:l[f]||null,dateTime:r[f]||null,imgUser:a[f]||null,comment:u[f]?this.showComment(T,u[f],f):null,likes:s[f]?(0,i.jsx)(o.Z,{likes:s[f]}):null,tieudeTiengTrung:d[f]||null,link:f?"/dashboard/".concat(b,"/").concat(f.split("&")[1]):null,title:c[f]||null,baidich:t[f]||null,img:h[f]?"https://img.youtube.com/vi/".concat(h[f],"/sddefault.jpg"):null,removeClick:()=>this.removeClick(T,f,!1),sendCmtHandle:()=>this.sendCmtHandle(T,f),commentText:n[f]||"",onChangeHandle:e=>this.handleCommentChange(f,e),likeClick:()=>this.likeClick(T,f,g[f]),isLiked:g[f],tiengTrungs:v[f]||null,dichNghias:k[f]||null,userKey:b||null},y)}):null},this.showComment=(e,t,a)=>(0,i.jsx)("div",{children:t&&t.map((t,l)=>(0,i.jsx)(g,{imgUser:t.userImage,username:t.username,cmt:t.cmt,dateTime:t.dateTime,removeClick:()=>this.removeClick("".concat(e,"/comment/").concat(t.id),a,!0)},l))}),this.state={datas:null,usernames:null,dateTimes:null,tieudes:null,links:null,likes:null,comments:null,weblinks:null,tieudeTiengTrungs:null,authors:null,imgAuthors:null,baidichs:null,error:null,nav:!1,loading:!1,commentTexts:{},isLikedMap:{},flagLogin:!1,flagAdmin:!1}}}function g(e){return(0,i.jsxs)("div",{className:"itemCard-UserName",children:[(0,i.jsxs)("div",{className:"itemCard-UserName-2",children:[(0,i.jsx)(d.default,{src:e.imgUser?e.imgUser:u.Z,alt:"img",width:500,height:500}),(0,i.jsxs)("div",{className:"itemCard-UserName-container ",children:[(0,i.jsxs)("div",{className:"itemCard-UserName-container-1",children:[(0,i.jsx)("h6",{className:"username-card1",children:e.username}),(0,i.jsx)("p",{children:e.cmt})]}),(0,i.jsx)("span",{className:"Time",style:{margin:"0"},children:(0,c.o)(e.dateTime)})]})]}),localStorage.getItem("name")==e.username?(0,i.jsx)("div",{className:"itemCard-UserName-1",children:(0,i.jsx)("button",{className:"btn btn-options",onClick:e.removeClick,style:{padding:"0",margin:"0"},children:(0,i.jsx)("i",{className:"fa-solid fa-trash"})})}):null]})}t.default=h},1656:function(){},594:function(){}},function(e){e.O(0,[734,610,481,461,630,648,609,708,669,971,23,560],function(){return e(e.s=7792)}),_N_E=e.O()}]);