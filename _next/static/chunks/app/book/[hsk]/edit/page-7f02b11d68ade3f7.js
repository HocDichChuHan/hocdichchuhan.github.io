(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5318],{15686:function(e,n,i){Promise.resolve().then(i.bind(i,96395))},96395:function(e,n,i){"use strict";i.d(n,{default:function(){return g}});var l=i(57437),a=i(2265),t=i(66802),r=i(12808);i(19768);var s=i(23508),c=i(60516),u=i(65606),o=i(64379),d=i.n(o),h=i(34231);i(39731);var m=i(63806);i(50658),i(32608),i(51146),i(85328);var p=i(27593);function g(e){let{hsk:n}=e,[i,o]=(0,a.useState)(!0),[g,x]=(0,a.useState)(!1),[v,b]=(0,a.useState)(!1),[j,f]=(0,a.useState)(n),[k,C]=(0,a.useState)([]),[y,N]=(0,a.useState)(""),[Z,T]=(0,a.useState)(null);(0,a.useRef)(null),(0,a.useRef)(null),(0,a.useRef)(null),(0,a.useRef)(null),(0,a.useRef)(null);let w=(0,a.useRef)(null),D=(0,a.useRef)([]);(0,a.useEffect)(()=>{D.current=k.map((e,n)=>{var i;return null!==(i=D.current[n])&&void 0!==i?i:a.createRef()})},[k]),(0,a.useEffect)(()=>{let e=(0,s.GJ)(),i=(0,s.bg)();if(b(e),x(i),!e){window.location.href="/book/".concat(n);return}(async()=>{o(!0),d().fire({title:"Đang tải dữ liệu...",html:"Vui l\xf2ng chờ trong gi\xe2y l\xe1t",background:"#f8f9fa",color:"#333",allowOutsideClick:!1,didOpen:()=>{d().showLoading()}});try{let e=(0,c.iH)(u.db,"/users/book/".concat(n)),i=await (0,c.U2)(e);if(i.exists()){let e=i.val();if(!e)return;C(e.mucluc||""),N(e.thamchieu||"")}d().close()}catch(e){console.error("Lỗi khi lấy dữ liệu:",e),d().fire({icon:"error",title:"Lỗi khi tải dữ liệu",text:e.message||"Đ\xe3 xảy ra lỗi kh\xf4ng x\xe1c định. Vui l\xf2ng thử lại sau.",confirmButtonText:"Đ\xf3ng"})}finally{o(!1)}})()},[]);let L=async()=>{try{let e=(0,c.iH)(u.db,"/users/book/".concat(j));await (0,c.t8)(e,{mucluc:k,thamchieu:y}),d().fire("✅ Th\xe0nh c\xf4ng","Dữ liệu đ\xe3 được lưu.","success")}catch(e){console.error("❌ Lỗi khi lưu:",e),d().fire("❌ Lỗi","C\xf3 lỗi xảy ra khi lưu dữ liệu.","error")}},S=e=>{C(n=>n.map(n=>n.id===e?{...n,content:[...n.content,{number:n.content.length+1,name:"Listen ".concat(n.content.length+1),pagenum:"",mp3link:"",nguphap:[],tumoi:[],pagethamchieu:""}]}:n))},E=function(e,n,i){let l=arguments.length>3&&void 0!==arguments[3]&&arguments[3];C(a=>a.map(a=>a.id===e?{...a,content:a.content.map(e=>e.number===n?{...e,nguphap:l?(Array.isArray(e.nguphap)?e.nguphap:[]).filter(e=>e!==i):[...Array.isArray(e.nguphap)?e.nguphap:[],i]}:e)}:a))},R=(e,n,i,l)=>{C(a=>a.map(a=>a.id===e?{...a,content:a.content.map(e=>e.number===n?{...e,nguphap:(Array.isArray(e.nguphap)?e.nguphap:[]).map((e,n)=>n===i?l:e)}:e)}:a))},_=(e,n,i)=>{C(l=>l.map(l=>l.id===e?{...l,content:l.content.map(e=>e.number===n?{...e,tumoi:i}:e)}:l))},z=(e,n)=>{C(i=>i.map(i=>i.id===e?{...i,name:n}:i))},A=(e,n,i,l)=>{C(a=>a.map(a=>a.id===e?{...a,content:a.content.map(e=>e.number===n?{...e,[i]:l}:e)}:a))},B=(e,n,i,l)=>{C(a=>a.map(a=>a.id===e?{...a,content:a.content.map(e=>e.number===n?{...e,[i]:l}:e)}:a))};return(0,l.jsx)(t.Z,{body:(0,l.jsxs)("div",{className:"container",children:[(0,l.jsxs)("div",{style:{position:"fixed",height:"90vh",top:"60px",right:"10px",display:"flex",flexDirection:"column",overflow:"auto",gap:"8px",zIndex:9999},children:[(0,l.jsx)(r.Z,{size:"sm",onClick:()=>L(),children:"\uD83D\uDCBE Save"}),k.map((e,n)=>(0,l.jsxs)(r.Z,{size:"sm",variant:"outline-primary",className:"text-left",onClick:()=>{var e,i;return null===(i=D.current[n])||void 0===i?void 0:null===(e=i.current)||void 0===e?void 0:e.scrollIntoView({behavior:"smooth"})},children:["\uD83D\uDCD8 ",n+1,". ",e.name||"B\xe0i ".concat(e.id)]},e.id))]}),Z&&(0,l.jsx)(p.Z,{show:Z,onClose:()=>T(null),children:(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:Z}})}),(0,l.jsx)("h2",{children:"Edit list c\xe1c đường dẫn"}),(0,l.jsx)(r.Z,{ref:w,onClick:L,className:"btn btn-success mb-1",children:"\uD83D\uDCBE Lưu dữ liệu"}),(0,l.jsx)(h.Z,{value:j,placeholder:"Nhập ID",onChange:e=>f(e.target.value)}),(0,l.jsx)(h.Z,{value:y,placeholder:"id Tham CHiếu",onChange:e=>N(e.target.value)}),(0,l.jsx)("div",{children:k.map((e,n)=>(0,l.jsxs)("div",{ref:D.current[n],className:"border p-2 mb-3 rounded",children:[(0,l.jsxs)("h5",{children:["B\xe0i ",e.id]}),(0,l.jsx)(h.Z,{value:e.name,placeholder:"T\xean b\xe0i học",onChange:n=>z(e.id,n.target.value)}),(0,l.jsx)(r.Z,{size:"sm",className:"mt-2 mb-2",onClick:()=>S(e.id),children:"➕ Th\xeam Item"}),(0,l.jsx)("div",{className:"row",children:e.content.map(n=>(0,l.jsxs)("div",{className:"p-2 mb-3 col-12 col-md-6 border rounded",children:[(0,l.jsxs)("div",{className:"mb-1",children:[(0,l.jsx)("label",{children:(0,l.jsx)("strong",{children:"T\xean Item:"})}),(0,l.jsx)(h.Z,{value:n.name,placeholder:"T\xean item",onChange:i=>A(e.id,n.number,"name",i.target.value)})]}),(0,l.jsxs)("div",{className:"mb-1",children:[(0,l.jsx)("label",{children:(0,l.jsx)("strong",{children:"Trang:"})}),(0,l.jsx)(h.Z,{value:n.pagenum,placeholder:"Số trang",onChange:i=>A(e.id,n.number,"pagenum",i.target.value)})]}),(0,l.jsxs)("div",{className:"mb-1",children:[(0,l.jsx)("label",{children:(0,l.jsx)("strong",{children:"MP3 Link:"})}),(0,l.jsx)(h.Z,{value:n.mp3link,placeholder:"Link MP3",onChange:i=>A(e.id,n.number,"mp3link",i.target.value)})]}),(0,l.jsxs)("div",{className:"mb-1",children:[(0,l.jsx)("label",{children:(0,l.jsx)("strong",{children:"Ngữ ph\xe1p:"})}),(0,l.jsx)("ul",{children:n.nguphap&&n.nguphap.map((i,a)=>(0,l.jsxs)("li",{children:[(0,l.jsx)(h.Z,{value:i,placeholder:"Ngữ Ph\xe1p",onChange:i=>R(e.id,n.number,a,i.target.value)}),(0,l.jsx)(r.Z,{variant:"outline-success",size:"sm",onClick:()=>T(i),children:"View Html"}),(0,l.jsx)(r.Z,{variant:"outline-danger",size:"sm",onClick:()=>E(e.id,n.number,i,!0),children:"❌"})]},a))}),(0,l.jsx)(r.Z,{size:"sm",variant:"outline-primary",onClick:()=>{var i;return E(e.id,n.number,"Ngữ ph\xe1p ".concat((null===(i=n.nguphap)||void 0===i?void 0:i.length)||1))},children:"➕ Th\xeam ngữ ph\xe1p"})]}),(0,l.jsx)("div",{className:"mb-1",children:(0,l.jsx)(m.Z,{tumoilist:n.tumoi||[],setTumoilist:i=>_(e.id,n.number,i)})}),(0,l.jsxs)("div",{className:"mb-1",children:[(0,l.jsx)("label",{children:(0,l.jsx)("strong",{children:"Trang Tham Chiếu:"})}),(0,l.jsx)(h.Z,{value:n.pagethamchieu,placeholder:"Trang Page Tham Chiếu",onChange:i=>B(e.id,n.number,"pagethamchieu",i.target.value)})]})]},n.number))})]},e.id))}),(0,l.jsx)(r.Z,{onClick:()=>{let e={id:k.length+1,name:"B\xe0i ".concat(k.length+1),content:[]};C([...k,e])},className:"btn btn-primary mb-1",children:"+ Add Muc Luc"})]})})}}},function(e){e.O(0,[2866,9513,5527,8905,431,4358,7481,9208,9461,8765,4974,3539,8472,609,3830,9233,6901,6802,8551,658,3806,2571,2971,7023,1744],function(){return e(e.s=15686)}),_N_E=e.O()}]);